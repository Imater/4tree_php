(function(){function k(a){throw a;}var l=void 0,p=!0,q=null,r=!1;function aa(){return function(){}}function t(a){return function(){return this[a]}}function ba(a){return function(){return a}}var u,v=this;function ca(a){a=a.split(".");for(var b=v,c;c=a.shift();)if(b[c]!=q)b=b[c];else return q;return b}
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function x(a){return a!==l}function y(a){return"array"==da(a)}function z(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function B(a){return"string"==typeof a}function fa(a){return"boolean"==typeof a}function C(a){return"number"==typeof a}function ga(a){return"function"==da(a)}function D(a){var b=typeof a;return"object"==b&&a!=q||"function"==b}function ha(a){return a[ia]||(a[ia]=++ja)}
var ia="closure_uid_"+(1E9*Math.random()>>>0),ja=0;function ka(a,b,c){return a.call.apply(a.bind,arguments)}function la(a,b,c){a||k(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ma(a,b,c){ma=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ka:la;return ma.apply(q,arguments)}function na(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var oa=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=v;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&x(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function F(a,b){function c(){}c.prototype=b.prototype;a.K=b.prototype;a.prototype=new c};function H(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ga(Object.freeze)&&Object.freeze(this)}H.prototype.lower=l;H.prototype.upper=l;H.prototype.toJSON=function(){return pa(this)};function qa(a,b,c,d){return new H(a,b,c,d)}function ra(a){var b;y(a)?(b=sa(J(a)),b.push("\uffff")):B(a)?b=a+"\uffff":k(new K);return qa(a,b,r,p)}function pa(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}
function ta(a){return a==q?q:a instanceof ua?ua.bound(a.lower,a.upper,a.lowerOpen,a.upperOpen):a.upper!=q&&a.lower!=q?ua.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):a.upper!=q?ua.upperBound(a.upper,a.upperOpen):a.lower!=q?ua.lowerBound(a.lower,a.lowerOpen):q}
function va(a){if(a instanceof H)return"";if(a!=q){if(D(a)){for(var b in a)if(a.hasOwnProperty(b)&&!(0<=wa(["lower","upper","lowerOpen","upperOpen"],b)))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
H.prototype.pb=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;if(a.lower!=q&&(this.lower==q||a.lower>=this.lower))b=a.lower,d=a.lowerOpen||this.lowerOpen;if(a.upper!=q&&(this.upper==q||a.upper<=this.upper))c=a.upper,e=a.upperOpen||this.upperOpen;return qa(b,c,d,e)};
function xa(a,b,c,d,e,f){if(d)if(!d.lowerOpen&&!d.upperOpen&&d.lower!=q&&d.upper!=q&&0===ya(d.lower,d.upper))c?(e.push(a+" LIKE ?"),f.push("%"+za(d.lower,b,r)+"%")):(e.push(a+" = ?"),f.push(za(d.lower,b,r)));else{c&&k(new Aa("MultiEntryInequalQuery"));if(d.lower!=q){var g=d.lowerOpen?" > ":" >= ";e.push(a+g+"?");f.push(za(d.lower,b,c))}d.upper!=q&&(g=d.upperOpen?" < ":" <= ",e.push(a+g+"?"),f.push(za(d.upper,b,c)))}}
function Ba(a,b,c,d){var e,f,g,h;if("^"==a)return ra(b);"<"==a||"<="==a?(e=b,g="<"==a):">"==a||">="==a?(f=b,h=">"==a):"="==a||"=="==a?e=f=b:k(new K("invalid op: "+a));"<"==c||"<="==c?(e=d,g="<"==c):">"==c||">="==c?(f=d,h=">"==c):x(c)&&k(new K("invalid op2: "+c));return qa(f,e,h,g)}var ua=v.IDBKeyRange||v.webkitIDBKeyRange||H;function Ca(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function Ea(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function Fa(a){if(!Ga.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ha,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ia,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ja,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ka,"&quot;"));return a}var Ha=/&/g,Ia=/</g,Ja=/>/g,Ka=/\"/g,Ga=/[&<>\"]/;
function La(a){return Ea(a.replace(/  /g," &#160;"),l)}function Ma(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Na={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Oa={"'":"\\'"};
function L(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,h;if(!(h=Na[d])){if(!(31<e&&127>e))if(d in Oa)d=Oa[d];else if(d in Na)d=Oa[d]=Na[d];else{e=d;h=d.charCodeAt(0);if(31<h&&127>h)e=d;else{if(256>h){if(e="\\x",16>h||256<h)e+="0"}else e="\\u",4096>h&&(e+="0");e+=h.toString(16).toUpperCase()}d=Oa[d]=e}h=d}f[g]=h}b.push('"');return b.join("")};function Pa(a){Error.captureStackTrace?Error.captureStackTrace(this,Pa):this.stack=Error().stack||"";a&&(this.message=String(a))}F(Pa,Error);Pa.prototype.name="CustomError";function Ra(a,b){b.unshift(a);Pa.call(this,Ca.apply(q,b));b.shift()}F(Ra,Pa);Ra.prototype.name="AssertionError";function Sa(a,b){k(new Ra("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};var Ta=Array.prototype,wa=Ta.indexOf?function(a,b,c){return Ta.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(B(a))return!B(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ua=Ta.forEach?function(a,b,c){Ta.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Va=Ta.map?function(a,b,c){return Ta.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=B(a)?
a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Wa=Ta.some?function(a,b,c){return Ta.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return r};function Xa(a,b){var c=Ya(a,b,l);return 0>c?q:B(a)?a.charAt(c):a[c]}function Ya(a,b,c){for(var d=a.length,e=B(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}
function Za(a){if(!y(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function $a(a,b){var c=wa(a,b);0<=c&&Ta.splice.call(a,c,1)}function ab(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function bb(a,b,c,d){Ta.splice.apply(a,cb(arguments,1))}function cb(a,b,c){return 2>=arguments.length?Ta.slice.call(a,b):Ta.slice.call(a,b,c)}
function db(a,b){if(!z(a)||!z(b)||a.length!=b.length)return r;for(var c=a.length,d=eb,e=0;e<c;e++)if(!d(a[e],b[e]))return r;return p}function fb(a,b){return a>b?1:a<b?-1:0}function eb(a,b){return a===b};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function M(a,b){this.c=[];this.fa=a;this.h=b||q}u=M.prototype;u.da=r;u.Ea=r;u.qb=r;u.tc=r;u.Eb=r;u.rb=0;function gb(a,b){if(a.da)a.b instanceof M&&gb(a.b);else{if(a.a){var c=a.a;delete a.a;b?gb(c,b):(c.rb--,0>=c.rb&&gb(c))}a.fa?a.fa.call(a.h,a):a.Eb=p;a.da||a.m(new hb)}}u.Rb=function(a,b){this.qb=r;ib(this,a,b)};function ib(a,b,c){a.da=p;a.b=c;a.Ea=!b;kb(a)}function lb(a){a.da&&(a.Eb||k(new mb),a.Eb=r)}function N(a,b){lb(a);ib(a,p,b)}u.m=function(a){lb(this);ib(this,r,a)};
u.ba=function(a,b){return this.C(a,q,b)};u.Nb=function(a,b){return this.C(q,a,b)};u.sc=function(a,b){return this.C(a,a,b)};u.C=function(a,b,c){this.c.push([a,b,c]);this.da&&kb(this);return this};function nb(a){return Wa(a.c,function(a){return ga(a[1])})}
function kb(a){a.f&&(a.da&&nb(a))&&(v.clearTimeout(a.f),delete a.f);a.a&&(a.a.rb--,delete a.a);for(var b=a.b,c=r,d=r;a.c.length&&!a.qb;){var e=a.c.shift(),f=e[0],g=e[1],e=e[2];if(f=a.Ea?g:f)try{var h=f.call(e||a.h,b);x(h)&&(a.Ea=a.Ea&&(h==b||h instanceof Error),a.b=b=h);b instanceof M&&(d=p,a.qb=p)}catch(j){b=j,a.Ea=p,nb(a)||(c=p)}}a.b=b;d&&(b.C(ma(a.Rb,a,p),ma(a.Rb,a,r)),b.tc=p);c&&(a.f=v.setTimeout(function(){k(b)},0))}function ob(a){var b=new M;N(b,a);return b}
function pb(a){Error.captureStackTrace?Error.captureStackTrace(this,pb):this.stack=Error().stack||"";a&&(this.message=String(a))}F(pb,Error);function mb(){pb.call(this)}F(mb,pb);mb.prototype.message="Deferred has already fired";mb.prototype.name="AlreadyCalledError";function hb(){pb.call(this)}F(hb,pb);hb.prototype.message="Deferred was cancelled";hb.prototype.name="CancelledError";function qb(){return new M}var rb={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},sb=v.webkitIDBRequest&&"LOADING"in v.webkitIDBRequest?v.webkitIDBTransaction||v.IDBTransaction:v.IDBRequest&&"LOADING"in v.IDBRequest?v.IDBTransaction:rb,O=sb.READ_ONLY,P=sb.READ_WRITE,tb=sb.VERSION_CHANGE;function vb(a,b){return a?b?"prevunique":"prev":b?"nextunique":"next"};function wb(a,b){var c,d;2==arguments.length&&B(arguments[1])?(c=p,d=arguments[1].split(".")):d=(c=z(b))?b:arguments;for(c=c?0:1;c<d.length&&!(a=a[d[c]],!x(a));c++);return a}var xb={};
function yb(a){a=[a];for(var b=new zb,c=0,d,e;(e=a.pop())!==l;){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(xb);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),Ab(b,e);else if(e instanceof Date)c+=2,b.write(c),Ab(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>2|255,
(f|3)<<6)}c.write(0)}else if(e===xb)b.write(0);else return"";c=0}return b.trim().toString()}function Bb(a){for(var b=[],c=b,d=[],e,f,g=new Cb(a);g.ka()!=q;)if(0===g.a)c=d.pop();else{if(g.a===q)break;do{e=g.a/4|0;a=g.a%4;for(var h=0;h<e;h++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.a+4)g.ka();else break}while(1);1===a?c.push(Db(g)):2===a?c.push(new Date(Db(g))):3===a?c.push(Eb(g)):0===a&&(c=d.pop())}return b[0]}
function Ab(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Db(a){var b=a.ka()|0,c=b>>7?r:p,d=c?-1:1,e=(b&127)<<4,b=a.ka()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.ka()|0):a.ka()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Eb(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.ka();if(0===f||f==q)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Cb(a){this.a=q;var b=a.length-1,c=-1;this.ka=function(){return this.a=c<b?parseInt(a[++c]+a[++c],16):q}}
function zb(){var a=[],b;this.write=function(c){for(var d=0;d<arguments.length;d++)b=arguments[d].toString(16),a.push(2===b.length?b:b="0"+b)};this.toString=function(){return a.length?a.join(""):q};this.trim=function(){for(var b=a.length;"00"===a[--b];);a.length=++b;return this}}function Fb(a,b){var c=yb(a),d=yb(b);return c>d?1:c==d?0:-1};function K(a){Pa.call(this,a);this.name="ydn.error.ArgumentException"}F(K,Pa);F(K,Pa);function Gb(a){Error.captureStackTrace?Error.captureStackTrace(this,Gb):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}F(Gb,Error);Gb.prototype.name="ydn.error.InternalError";function Hb(a,b,c,d,e){if(!(b instanceof H)){var f;B(b)?f=Ba(b,c,d,e):b!=q?b instanceof H?f=b:D(b)?f=new H(b.lower,b.upper,b.lowerOpen,b.upperOpen):k(new K("Invalid key range: "+b+" of type "+typeof b)):f=q;b=f}this.a=b;this.aa=a}Hb.prototype.aa="";Hb.prototype.pb=function(a){if(this.aa!=a.aa)return q;a=this.a!=q&&a.a!=q?this.a.pb(a.a):this.a||a.a;return new Hb(this.aa,a)};function Ib(a,b){for(var c in a)b.call(l,a[c],c,a)}function Jb(a,b){for(var c=z(b),d=c?b:arguments,c=c?0:1;c<d.length&&!(a=a[d[c]],!x(a));c++);return a}var Kb="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Lb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Kb.length;f++)c=Kb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Nb,Qb,Rb,Sb;function Tb(){return v.navigator?v.navigator.userAgent:q}Sb=Rb=Qb=Nb=r;var Ub;if(Ub=Tb()){var Vb=v.navigator;Nb=0==Ub.indexOf("Opera");Qb=!Nb&&-1!=Ub.indexOf("MSIE");Rb=!Nb&&-1!=Ub.indexOf("WebKit");Sb=!Nb&&!Rb&&"Gecko"==Vb.product}var Wb=Nb,Xb=Qb,Yb=Sb,Zb=Rb;function $b(){var a=v.document;return a?a.documentMode:l}var ac;
a:{var bc="",cc;if(Wb&&v.opera)var dc=v.opera.version,bc="function"==typeof dc?dc():dc;else if(Yb?cc=/rv\:([^\);]+)(\)|;)/:Xb?cc=/MSIE\s+([^\);]+)(\)|;)/:Zb&&(cc=/WebKit\/(\S+)/),cc)var ec=cc.exec(Tb()),bc=ec?ec[1]:"";if(Xb){var fc=$b();if(fc>parseFloat(bc)){ac=String(fc);break a}}ac=bc}var gc={};
function hc(a){var b;if(!(b=gc[a])){b=0;for(var c=String(ac).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=/(\d*)(\D*)/g,n=/(\d*)(\D*)/g;do{var m=j.exec(g)||["","",""],s=n.exec(h)||["","",""];if(0==m[0].length&&0==s[0].length)break;b=((0==m[1].length?0:parseInt(m[1],10))<(0==s[1].length?0:parseInt(s[1],10))?-1:(0==m[1].length?0:parseInt(m[1],10))>(0==s[1].length?
0:parseInt(s[1],10))?1:0)||((0==m[2].length)<(0==s[2].length)?-1:(0==m[2].length)>(0==s[2].length)?1:0)||(m[2]<s[2]?-1:m[2]>s[2]?1:0)}while(0==b)}b=gc[a]=0<=b}return b}var ic=v.document,jc=!ic||!Xb?l:$b()||("CSS1Compat"==ic.compatMode?parseInt(ac,10):5);function kc(a){return lc(a||arguments.callee.caller,[])}
function lc(a,b){var c=[];if(0<=wa(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(nc(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=nc(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(lc(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function nc(a){if(oc[a])return oc[a];a=String(a);if(!oc[a]){var b=/function ([^\(]+)/.exec(a);oc[a]=b?b[1]:"[Anonymous]"}return oc[a]}var oc={};function pc(a,b,c,d,e){"number"==typeof e||qc++;this.h=d||oa();this.f=a;this.e=b;this.c=c;delete this.b;delete this.a}pc.prototype.b=q;pc.prototype.a=q;var qc=0;function rc(a){this.f=a}rc.prototype.c=q;rc.prototype.b=q;rc.prototype.e=q;rc.prototype.a=q;function sc(a,b){this.name=a;this.value=b}sc.prototype.toString=t("name");var tc=new sc("SHOUT",1200),uc=new sc("SEVERE",1E3),vc=new sc("WARNING",900),wc=new sc("INFO",800),xc=new sc("CONFIG",700),yc=new sc("FINE",500),zc=new sc("FINER",400),Ac=new sc("FINEST",300),Bc=[new sc("OFF",Infinity),tc,uc,vc,wc,xc,yc,zc,Ac,new sc("ALL",0)],Cc=q;rc.prototype.getName=t("f");
function Dc(a){if(a.b)return a.b;if(a.c)return Dc(a.c);Sa("Root logger has no level set.");return q}rc.prototype.log=function(a,b,c){if(a.value>=Dc(this).value){a=this.h(a,b,c);b="log:"+a.e;v.console&&(v.console.timeStamp?v.console.timeStamp(b):v.console.markTimeline&&v.console.markTimeline(b));v.msWriteProfilerMark&&v.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=l;f=c.a[e];e++)f(d);b=b.c}}};
rc.prototype.h=function(a,b,c){var d=new pc(a,String(b),this.f);if(c){d.b=c;var e;var f=arguments.callee.caller;try{var g;var h=ca("window.location.href");if(B(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:h,stack:"Not available"};else{var j,n,m=r;try{j=c.lineNumber||c.Xc||"Not available"}catch(s){j="Not available",m=p}try{n=c.fileName||c.filename||c.sourceURL||v.$googDebugFname||h}catch(w){n="Not available",m=p}g=m||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,
name:c.name,lineNumber:j,fileName:n,stack:c.stack||"Not available"}:c}e="Message: "+Fa(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+Fa(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+Fa(kc(f)+"-> ")}catch(A){e="Exception trying to expose exception! You win, we lose. "+A}d.a=e}return d};function Ec(a,b){a.log(uc,b,l)}function Q(a,b){a.log(vc,b,l)}function Fc(a,b){a.log(yc,b,l)}function R(a,b){a.log(zc,b,l)}
function T(a,b){a.log(Ac,b,l)}var Gc={},Hc=q;function Ic(){Hc||(Hc=new rc(""),Gc[""]=Hc,Hc.b=xc)}function Jc(){Ic();return Hc}function U(a){Ic();var b;if(!(b=Gc[a])){b=new rc(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=U(a.substr(0,c));c.e||(c.e={});c.e[d]=b;b.c=c;Gc[a]=b}return b};function V(a,b,c,d,e,f){B(a)||k(new K("store name must be a string"));this.S=a;this.index=b;this.c=B(this.index);this.R=x(f)?f:!!B(this.index);fa(this.R)||k(new K("key_only"));x(d)&&!fa(d)&&k(new K("reverse"));x(e)&&!fa(e)&&k(new K("unique"));a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.direction=a;(d=va(c))&&k(new K("Invalid key range: "+d));this.M=ta(c);this.Va=[];this.Ub=[];this.Vb=[];this.tb=[];this.sb=[];this.e=0;this.F=this.b=this.a=l;this.Ha=r}
function Kc(a,b,c){3<arguments.length&&k(new K("too many argument"));V.call(this,a,l,b,c,l,p)}F(Kc,V);function Lc(a,b,c,d,e){B(b)||k(new K("index name must be string"));V.call(this,a,b,c,d,e,p)}F(Lc,V);function Mc(a,b,c){3<arguments.length&&k(new K("too many argument"));V.call(this,a,l,b,c,l,r)}F(Mc,V);function Nc(a,b,c,d,e){B(b)||k(new K("index name must be string"));V.call(this,a,b,c,d,e,r)}F(Nc,V);function Oc(a){return x(a.F)?a.F===r?a.Ha?"working":"resting":"completed":"initial"}u=V.prototype;
u.ic=U("ydn.db.Iterator");u.Jc=t("S");u.Da=t("index");u.F=l;u.Ha=r;u.r=t("a");u.Hc=function(){return this.c?this.b:this.a};u.Ic=function(){return this.M?this.M instanceof ua?this.M:ua.bound(this.M.lower,this.M.upper,this.M.lowerOpen,this.M.upperOpen):q};u.R=p;u.Kc=t("R");u.toJSON=function(){return{store:this.S,index:this.index,key_range:this.M?pa(this.M):q,direction:this.direction}};
u.toString=function(){var a=x(this.index)?":"+this.index:"";if(this.a!=q){var b="]",c="[",d=Oc(this);"working"==d?(c="{",b="}"):"resting"==d&&(c="(",b=")");a+=" "+c+this.a+(this.c?", "+this.b:"")+b}b=this.c?"Index":"";b+=this.R?"Key":"Value";return b+"Iterator:"+this.S+a};u.key=t("a");u.Dc=function(a,b){this.a=a;this.b=b};u.Gc=t("e");u.vc=t("F");u.stores=function(){return[this.S].concat(this.La)};u.La=[];u.Ac=[];u.Ob=[];
u.join=function(a,b,c){B(a)||k(new K);(!B(b)||!x(b))&&k(new K);(!B(c)||!x(c))&&k(new K);this.La.push(a);this.Ac.push(c);this.Ob.push(b)};u.Lc=function(){return"prev"===this.direction||"prevunique"===this.direction};u.Mc=function(){return"nextunique"===this.direction||"prevunique"===this.direction};u.Va=[];u.Ub=[];u.Vb=[];u.tb=[];u.sb=[];function Pc(a){a.a=y(a.a)?ab(a.a):a.a;a.b=y(a.b)?ab(a.b):a.b;a.Ha=r;a.F=r;T(a.ic,a+": exited")}
function Qc(a,b,c,d){if(0<a.Va.length){var e,f,g=a.F===r;g?(e=a.a,f=a.b):a.e=0;a.Ha=p;var h=[],j=d.b(b,c,a.S,a.index,a.M,a.direction,a.R);j.ya(e,f,g);j.v=function(b,c){x(b)?(a.F=r,a.a=b,a.b=c,n()&&m()):(a.F=p,a.Ha=r)};e=function(b,c,d){n();x(c)&&(a.tb[b]=c,a.sb[b]=d);n()&&m()};for(f=0;f<a.Va.length;f++)g=d.b(b,c,a.Vb[f]||a.S,a.Va[f],a.Ub[f],a.direction,p),g.ya(a.tb[f],a.sb[f]),h.push(g),g.v=na(e,f);var n=function(){return!h.some(function(a){return a.U})},m=function(){for(var b=r,c=p,d=[],e=a.a,f=
0;f<h.length;f++){var g=h[f];if(g.Y()){var n=ya(a.a,g.r());d[f]=n;1===n?c=r:-1===n&&(c=r,b=p,1===ya(g.r(),e)&&(e=g.r()))}else c=r}if(c){j.u(j.r(),j.Jb(),j.ib());for(f=0;f<h.length;f++)h[f].forward(p)}else if(b){e!=a.a&&j.Ca(e);for(f=0;f<h.length;f++)0==d[f]?h[f].D(e):-1==d[f]?h[f].D(e):h[f].Y()?e!=h[f].r()&&h[f].D(e):h[f].D(e)}else{a.a!=e&&j.D(e);for(f=0;f<h.length;f++)(!h[f].Y()||0!==ya(h[f].r(),e))&&h[f].D(e)}};b=j}else{var s;(e=a.F===r)?(g=a.a,s=a.b):a.e=0;a.F=l;var w=d.b(b,c,a.S,a.index,a.M,a.direction,
a.R);T(a.ic,a+" created "+w);w.v=function(b,c,d){x(b)?(a.a=b,a.b=c,a.e++,w.u(b,c,d)):(a.F=p,w.u(l,l,l))};w.ya(g,s,e);b=w}return b}u.Nc=function(){"working"==Oc(this)&&k(new Rc("working"));this.e=0;this.F=this.b=this.a=l};function Sc(a,b,c,d,e,f){M.call(this,e,f);this.G=a;this.e=[];this.l=!!b;this.bb=!!c;this.$a=!!d;for(b=0;b<a.length;b++)a[b].C(ma(this.q,this,b,p),ma(this.q,this,b,r));0==a.length&&!this.l&&N(this,this.e)}F(Sc,M);Sc.prototype.ea=0;Sc.prototype.q=function(a,b,c){this.ea++;this.e[a]=[b,c];this.da||(this.l&&b?N(this,[a,c]):this.bb&&!b?this.m(c):this.ea==this.G.length&&N(this,this.e));this.$a&&!b&&(c=q);return c};Sc.prototype.m=function(a){Sc.K.m.call(this,a);Ua(this.G,function(a){gb(a)})};function Tc(a){Error.captureStackTrace?Error.captureStackTrace(this,Tc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}F(Tc,Error);function Uc(a){Error.captureStackTrace?Error.captureStackTrace(this,Uc):this.stack=Error().stack||"";a&&(this.message=String(a))}F(Uc,Error);Uc.prototype.name="ydn.db.InternalError";
function Vc(a){Error.captureStackTrace?Error.captureStackTrace(this,Vc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}F(Vc,Error);function Wc(a){Error.captureStackTrace?Error.captureStackTrace(this,Wc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}F(Wc,Error);function Xc(a){Error.captureStackTrace?Error.captureStackTrace(this,Xc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}
F(Xc,Error);Xc.prototype.name="NotFoundError";function Yc(a){Error.captureStackTrace?Error.captureStackTrace(this,Yc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="DataCloneError"}F(Yc,Error);function Zc(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Zc):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}F(Zc,Error);
function $c(a,b){Error.captureStackTrace?Error.captureStackTrace(this,$c):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}F($c,Error);function ad(a){Error.captureStackTrace?Error.captureStackTrace(this,ad):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}F(ad,Error);
function bd(a){Error.captureStackTrace?Error.captureStackTrace(this,bd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}F(bd,Error);function cd(a,b,c){var d;D(a)?(d=a.store,b=a.id,a.parent!=q&&(c=new cd(a.parent))):x(b)?d=a:(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new cd(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],x(b)||k(Error("Invalid key value: "+a)));this.a=d;this.id=b;this.b=c||q}u=cd.prototype;u.toJSON=function(){var a={store:this.a,id:this.id};this.b&&(a.parent=this.b.toJSON());return a};u.valueOf=function(){return(this.b?this.b.valueOf()+"^|":"")+this.a+"^:"+this.id};
u.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};u.Pc=t("a");u.wc=t("id");u.Oc=t("b");function dd(a,b,c){this.pa=a;this.a=b;this.f=c}dd.prototype.d=U("ydn.db.crud.req.RequestExecutor");dd.prototype.pa="";dd.prototype.f="";dd.prototype.toString=function(){return"RequestExecutor:"+this.f};function ed(a){Error.captureStackTrace?Error.captureStackTrace(this,ed):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}F(ed,Error);function Aa(a){Error.captureStackTrace?Error.captureStackTrace(this,Aa):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}F(ed,Error);Aa.prototype.name="ydn.error.NotSupportedException";
function fd(a){Error.captureStackTrace?Error.captureStackTrace(this,fd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}F(fd,Error);function gd(a){Error.captureStackTrace?Error.captureStackTrace(this,gd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}F(gd,Error);gd.prototype.name="ydn.InternalError";
function hd(a){Error.captureStackTrace?Error.captureStackTrace(this,hd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstrainError"}F(hd,Error);function id(a){Error.captureStackTrace?Error.captureStackTrace(this,id):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}F(ed,Error);
function Rc(a){Error.captureStackTrace?Error.captureStackTrace(this,Rc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}F(Rc,Error);U("ydn");function sa(a){if(!B(a)||/^[\s\xa0]*$/.test(a))return{};try{return JSON.parse(a)}catch(b){k(b)}}function jd(a){var b;try{b=J(a)}catch(c){b=""}return b?b.substr(0,70):""}function J(a){return JSON.stringify(a)};function kd(a,b,c){dd.call(this,a,b,c)}F(kd,dd);u=kd.prototype;u.d=U("ydn.db.crud.req.IndexedDb");u.Ta=function(a,b,c,d){function e(b){var n=a.objectStore(d[b]).count();n.onsuccess=function(a){g[b]=a.target.result;b++;b==d.length?(R(f.d,"success "+h),c(g),c=q):e(b)};n.onerror=function(a){Q(f.d,"error "+h);c(a,p);c=q}}var f=this,g=[],h="TxNo:"+b+" countStores: "+d;T(this.d,h);0==d.length?(c([]),c=q):e(0)};
u.nb=function(a,b,c,d,e,f){a=a.objectStore(d);var g="TxNo:"+b+" addObject: "+d+" "+f;T(this.d,g);var h=this,j;j=x(f)?a.add(e,f):a.add(e);j.onsuccess=function(a){T(h.d,"success "+g);c(a.target.result)};j.onerror=function(){T(h.d,"error "+g);c(j.error||Error(),p)}};
u.Ab=function(a,b,c,d,e,f){a=a.objectStore(d);var g="TxNo:"+b+" putObject: "+d+" "+(x(f)?f:"");T(this.d,g);var h=this;b=x(f)?a.put(e,f):a.put(e);b.onsuccess=function(a){T(h.d,"success "+g);c(a.target.result)};b.onerror=function(a){"DataError"==a.name&&(a=J(e),a=new Tc(d+": "+a.substring(0,70)));T(h.d,"error "+g);c(a,p)}};
u.ob=function(a,b,c,d,e,f){function g(a){var b;b=f!=q?m.add(e[a],f[a]):m.add(e[a]);b.onsuccess=function(b){j++;h[a]=b.target.result;j==e.length?(T(n.d,"success "+s),c(h)):(b=a+10,b<e.length&&g(b))};b.onerror=function(b){j++;"DataError"==b.name?b=new Tc('put to "'+d+'": '+a+" of "+e.length):"DataCloneError"==b.name&&(b=new Yc('put to "'+d+'": '+a+" of "+e.length));T(n.d,"error "+s);c(b,p)}}var h=[],j=0,n=this,m=a.objectStore(d),s="TxNo:"+b+" addObjects: "+d+" "+e.length+" objects";T(this.d,s);if(0<
e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
u.Bb=function(a,b,c,d,e,f){function g(a){var b;b=f!=q?w.put(e[a],f[a]):w.put(e[a]);b.onsuccess=function(b){n++;j[a]=b.target.result;n==e.length?h():(b=a+10,b<e.length&&g(b))};b.onerror=function(c){n++;Q(s.d,"request result "+c.name+' error when put to "'+d+'" for object "'+jd(e[a])+'" at index '+a+" of "+e.length+" objects.");j[a]=b.error||c.target.result;m=p;n==e.length?h():(c=a+10,c<e.length&&g(c))}}function h(){m?(T(s.d,"error "+A),c(j,p)):(T(s.d,"success "+A),c(j))}var j=[],n=0,m=r,s=this,w=a.objectStore(d),
A="TxNo:"+b+" putObjects: "+d+" "+e.length+" objects";T(this.d,A);if(0<e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
u.cc=function(a,b,c,d,e){function f(b){var c=e[b],s=c.a,I=a.objectStore(s),Da;Da=I.keyPath===q?I.put(d[b],c.id):I.put(d[b]);Da.onsuccess=function(a){j++;h[b]=a.target.result;j==d.length?g():(a=b+10,a<d.length&&f(a))};Da.onerror=function(a){j++;Q(m.d,"request result "+a.name+' error when put keys to "'+s+'" for object "'+jd(d[b])+'" at index '+b+" of "+d.length+" objects.");h[b]=Da.error||a.target.result;n=p;j==d.length?g():(a=b+10,a<d.length&&f(a))}}function g(){n?(T(m.d,"error "+s),c(h,p)):(T(m.d,
"success "+s),c(h))}var h=[],j=0,n=r,m=this,s="TxNo:"+b+" putByKeys: of "+d.length+" objects";T(this.d,s);if(0<d.length)for(b=0;10>b&&b<d.length;b++)f(b);else g()};u.Cb=function(a,b,c,d,e){var f=this;a=a.objectStore(d);var g="TxNo:"+b+" clearById: "+d+" "+e;T(this.d,g);b=a.openCursor(e);b.onsuccess=function(a){var b=a.target.result;b?(b=b["delete"](),b.onsuccess=function(){T(f.d,"success "+g);c(1)},b.onerror=function(){c(a,p)}):c(l)};b.onerror=function(a){T(f.d,"error "+g);c(a,p)}};
u.ec=function(a,b,c,d,e){var f=this,g=a.objectStore(d);a=g.count(e);var h="TxNo:"+b+" clearByKeyRange: "+d+" "+e;T(this.d,h);a.onsuccess=function(a){var b=a.target.result;a=g["delete"](e);a.onsuccess=function(){T(f.d,"success "+h);c(b)};a.onerror=function(a){T(f.d,"error "+h);c(a,p)}};a.onerror=function(a){T(f.d,"count error "+h);c(a,p)}};
u.Pb=function(a,b,c,d,e){var f=this;a=a.objectStore(d);var g="TxNo:"+b+" clearByKeyRange: "+d+" "+e;T(this.d,g);b=a["delete"](e);b.onsuccess=function(){T(f.d,"success "+g);c(l)};b.onerror=function(a){T(f.d,"error "+g);c(a,p)}};
u.dc=function(a,b,c,d,e,f){var g=this;a=a.objectStore(d).index(e);var h="TxNo:"+b+" clearByIndexKeyRange: "+d+":"+e+" "+f;T(this.d,h);b=a.openCursor(f);var j=0;b.onsuccess=function(a){var b=a.target.result;b?(a=b["delete"](),a.onsuccess=function(){j++;b["continue"]()},a.onerror=function(a){T(g.d,"error "+h);k(a)}):(T(g.d,"success "+h),c(j))};b.onerror=function(a){T(g.d,"error "+h);c(a,p)}};
u.Ra=function(a,b,c,d){var e=this,f=d.length,g=0,h="TxNo:"+b+" clearByStores: "+d;T(this.d,h);for(b=0;b<f;b++){var j=a.objectStore(d[b]).clear();j.onsuccess=function(){g++;g==f&&(T(e.d,"success "+h),c(g))};j.onerror=function(a){g++;g==f&&(T(e.d,"error "+h),c(a,p))}}};
function ld(a,b,c,d,e,f,g,h,j,n,m){var s=[];b=b.objectStore(e);h=vb(h,m);var w="TxNo:"+c+" listByKeyRange: "+e+(f?":"+f:"")+(g?J(g):"");T(a.d,w);c=f?b.index(f).openCursor(g,h):b.openCursor(g,h);var A=r;c.onsuccess=function(b){if(b=b.target.result)if(!A&&0<n)A=p,b.advance(n);else if(s.push(b.value),s.length<j)b["continue"]();else T(a.d,"success "+w),d(s);else T(a.d,"success "+w),d(s)};c.onerror=function(b){T(a.d,"error "+w);d(b,p)}}u.Ja=function(a,b,c,d,e,f,g,h){ld(this,a,b,c,d,q,e,f,g,h)};
u.Ia=function(a,b,c,d,e,f,g,h,j,n){ld(this,a,b,c,d,e,f,g,h,j,n)};u.Yb=function(a,b,c,d,e,f,g,h){var j=[],n=this;a=a.objectStore(d);f=vb(f);var m="TX"+b+" keysByKeyRange: "+d+" "+e;T(this.d,m);b=a.openCursor(e,f);var s=r;b.onsuccess=function(a){if(a=a.target.result)if(!s&&0<h)s=p,a.advance(h);else if(j.push(a.key),j.length<g)a["continue"]();else T(n.d,"success "+m),c(j);else T(n.d,"success "+m),c(j)};b.onerror=function(a){T(n.d,"error "+m);c(a,p)}};
u.Xb=function(a,b,c,d,e,f,g,h,j,n){var m=[],s=this;a=a.objectStore(d).index(e);var w="TxNo:"+b+" keysByStore: "+d+":"+e+" "+f;T(this.d,w);b=a.openKeyCursor(f,vb(g,n));var A=r;b.onsuccess=function(a){if(a=a.target.result)if(!A&&0<j)A=p,a.advance(j);else{if(m.push(a.primaryKey),m.length<h)a["continue"]()}else T(s.d,"success "+w),c(m)};b.onerror=function(a){T(s.d,"error "+w);c(a,p)}};
u.Wa=function(a,b,c,d,e){var f=this,g="TxNo:"+b+" getById: "+d+":"+e;T(this.d,g);a=a.objectStore(d).get(e);a.onsuccess=function(a){T(f.d,"success "+g);c(a.target.result)};a.onerror=function(a){T(f.d,"error "+g);c(a,p)}};
u.wb=function(a,b,c,d,e){function f(a){if(e[a]==q)if(j++,h[a]=l,j==m)T(g.d,"success "+s),c(h);else{var b=a+10;b<m&&f(b)}var d;try{d=n.get(e[a])}catch(I){"DataError"==I.name&&k(new Tc(e[a])),k(I)}d.onsuccess=function(b){j++;h[a]=b.target.result;j==m?(T(g.d,"success "+s),c(h)):(b=a+10,b<m&&f(b))};d.onerror=function(a){j++;T(g.d,"error "+s);c(a,p)}}var g=this,h=[],j=0,n=a.objectStore(d),m=e.length,s="TxNo:"+b+" listByIds: "+d+":"+m+" ids";T(this.d,s);if(0<m)for(a=0;10>a&&a<m;a++)f(a);else c([])};
u.xb=function(a,b,c,d){function e(b){var m=d[b],m=a.objectStore(m.a).get(m.id);m.onsuccess=function(a){h++;g[b]=a.target.result;h==d.length?(T(f.d,"success "+j),c(g)):(a=b+10,a<d.length&&e(a))};m.onerror=function(a){h++;T(f.d,"error "+j);c(a,p)}}var f=this,g=[],h=0,j="TxNo:"+b+" listByKeys: "+d.length+" ids";T(this.d,j);if(0<d.length)for(b=0;10>b&&b<d.length;b++)e(b);else c([])};
u.oa=function(a,b,c,d,e,f){var g=this;a=a.objectStore(d);var h="TxNo:"+b+" countKeyRange: "+d+(f?":"+f:"")+(e?":"+J(e):"");T(this.d,h);f!=q?(b=a.index(f),e=e!=q?b.count(e):b.count()):e=e!=q?a.count(e):a.count();e.onsuccess=function(a){T(g.d,"success "+h);c(a.target.result)};e.onerror=function(a){T(g.d,"error "+h);c(a,p)}};function md(){0!=nd&&(od[ha(this)]=this)}var nd=0,od={};md.prototype.ea=r;md.prototype.s=function(){if(!this.ea&&(this.ea=p,this.qa(),0!=nd)){var a=ha(this);delete od[a]}};md.prototype.qa=function(){if(this.fa)for(;this.fa.length;)this.fa.shift()()};var pd=!Xb||Xb&&9<=jc,qd=Xb&&!hc("9");!Zb||hc("528");Yb&&hc("1.9b")||Xb&&hc("8")||Wb&&hc("9.5")||Zb&&hc("528");Yb&&!hc("8")||Xb&&hc("9");function rd(a,b){this.type=a;this.a=this.target=b}rd.prototype.s=aa();rd.prototype.b=r;rd.prototype.c=p;rd.prototype.ub=function(){this.c=r};function sd(a){sd[" "](a);return a}sd[" "]=aa();function td(a,b){a&&ud(this,a,b)}F(td,rd);u=td.prototype;u.target=q;u.clientX=0;u.clientY=0;u.Tb=q;function ud(a,b,c){var d=a.type=b.type;rd.call(a,d);a.target=b.target||b.srcElement;a.a=c;if((c=b.relatedTarget)&&Yb)try{sd(c.nodeName)}catch(e){}a.clientX=b.clientX!==l?b.clientX:b.pageX;a.clientY=b.clientY!==l?b.clientY:b.pageY;a.Tb=b;b.defaultPrevented&&a.ub();delete a.b}
u.ub=function(){td.K.ub.call(this);var a=this.Tb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,qd)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var vd=0;function wd(){}wd.prototype.key=0;wd.prototype.la=r;wd.prototype.Qa=r;wd.prototype.handleEvent=function(a){return this.a?this.ga.call(this.vb||this.src,a):this.ga.handleEvent.call(this.ga,a)};var xd={},yd={},zd={},Ad={};
function Bd(a,b,c,d,e){if(y(b))for(var f=0;f<b.length;f++)Bd(a,b[f],c,d,e);else{a:{b||k(Error("Invalid event type"));d=!!d;var g=yd;b in g||(g[b]={N:0,z:0});g=g[b];d in g||(g[d]={N:0,z:0},g.N++);var g=g[d],f=ha(a),h;g.z++;if(g[f]){h=g[f];for(var j=0;j<h.length;j++)if(g=h[j],g.ga==c&&g.vb==e){if(g.la)break;h[j].Qa=r;a=h[j];break a}}else h=g[f]=[],g.N++;var n=Cd,m=pd?function(a){return n.call(m.src,m.ga,a)}:function(a){a=n.call(m.src,m.ga,a);if(!a)return a},j=m,s=g=new wd;ga(c)?s.a=p:c&&c.handleEvent&&
ga(c.handleEvent)?s.a=r:k(Error("Invalid listener argument"));s.ga=c;s.b=j;s.src=a;s.type=b;s.capture=!!d;s.vb=e;s.Qa=r;s.key=++vd;s.la=r;g.Qa=r;j.src=a;j.ga=g;h.push(g);zd[f]||(zd[f]=[]);zd[f].push(g);a.addEventListener?(a==v||!a.Sb)&&a.addEventListener(b,j,d):a.attachEvent(b in Ad?Ad[b]:Ad[b]="on"+b,j);a=g}xd[a.key]=a}}
function Dd(a,b,c,d,e){if(y(b))for(var f=0;f<b.length;f++)Dd(a,b[f],c,d,e);else{d=!!d;a:{f=yd;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ha(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].ga==c&&a[f].capture==d&&a[f].vb==e){Ed(a[f].key);break}}}
function Ed(a){var b=xd[a];if(b&&!b.la){var c=b.src,d=b.type,e=b.b,f=b.capture;c.removeEventListener?(c==v||!c.Sb)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in Ad?Ad[d]:Ad[d]="on"+d,e);c=ha(c);zd[c]&&(e=zd[c],$a(e,b),0==e.length&&delete zd[c]);b.la=p;if(b=yd[d][f][c])b.ac=p,Fd(d,f,c,b);delete xd[a]}}
function Fd(a,b,c,d){if(!d.ab&&d.ac){for(var e=0,f=0;e<d.length;e++)d[e].la?d[e].b.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.ac=r;0==f&&(delete yd[a][b][c],yd[a][b].N--,0==yd[a][b].N&&(delete yd[a][b],yd[a].N--),0==yd[a].N&&delete yd[a])}}function Gd(a,b,c,d,e){var f=1;b=ha(b);if(a[b]){var g=--a.z,h=a[b];h.ab?h.ab++:h.ab=1;try{for(var j=h.length,n=0;n<j;n++){var m=h[n];m&&!m.la&&(f&=Hd(m,e)!==r)}}finally{a.z=Math.max(g,a.z),h.ab--,Fd(c,d,b,h)}}return Boolean(f)}
function Hd(a,b){a.Qa&&Ed(a.key);return a.handleEvent(b)}
function Cd(a,b){if(a.la)return p;var c=a.type,d=yd;if(!(c in d))return p;var d=d[c],e,f;if(!pd){e=b||ca("window.event");var g=p in d,h=r in d;if(g){if(0>e.keyCode||e.returnValue!=l)return p;a:{var j=r;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(n){j=p}if(j||e.returnValue==l)e.returnValue=p}}j=new td;ud(j,e,this);e=p;try{if(g){for(var m=[],s=j.a;s;s=s.parentNode)m.push(s);f=d[p];f.z=f.N;for(var w=m.length-1;!j.b&&0<=w&&f.z;w--)j.a=m[w],e&=Gd(f,m[w],c,p,j);if(h){f=d[r];f.z=f.N;for(w=0;!j.b&&w<m.length&&
f.z;w++)j.a=m[w],e&=Gd(f,m[w],c,r,j)}}else e=Hd(a,j)}finally{m&&(m.length=0)}return e}c=new td(b,this);return e=Hd(a,c)};function Id(){md.call(this)}F(Id,md);u=Id.prototype;u.Sb=p;u.zb=q;u.addEventListener=function(a,b,c,d){Bd(this,a,b,c,d)};u.removeEventListener=function(a,b,c,d){Dd(this,a,b,c,d)};
function Jd(a,b){var c=b,d=c.type||c,e=yd;if(d in e){if(B(c))c=new rd(c,a);else if(c instanceof rd)c.target=c.target||a;else{var f=c,c=new rd(d,a);Lb(c,f)}var f=1,g,e=e[d],d=p in e,h;if(d){g=[];for(h=a;h;h=h.zb)g.push(h);h=e[p];h.z=h.N;for(var j=g.length-1;!c.b&&0<=j&&h.z;j--)c.a=g[j],f&=Gd(h,g[j],c.type,p,c)&&c.c!=r}if(r in e)if(h=e[r],h.z=h.N,d)for(j=0;!c.b&&j<g.length&&h.z;j++)c.a=g[j],f&=Gd(h,g[j],c.type,r,c)&&c.c!=r;else for(e=a;!c.b&&e&&h.z;e=e.zb)c.a=e,f&=Gd(h,e,c.type,r,c)&&c.c!=r}}
u.qa=function(){Id.K.qa.call(this);var a=0;if(this!=q){var b=ha(this);if(zd[b])for(var b=zd[b],c=b.length-1;0<=c;c--)Ed(b[c].key),a++}else Ib(xd,function(b,c){Ed(c);a++});this.zb=q};function Kd(a,b,c){ga(a)?c&&(a=ma(a,c)):a&&"function"==typeof a.handleEvent?a=ma(a.handleEvent,a):k(Error("Invalid listener argument"));2147483647<b||v.setTimeout(a,b||0)};function Ld(a,b,c){dd.call(this,a,b,c)}F(Ld,dd);u=Ld.prototype;u.nb=function(a,b,c,d,e,f){a=Md(a,e,d,f);c(a)};u.Ab=function(a,b,c,d,e,f){a=Md(a,e,d,f);c(a)};u.ob=function(a,b,c,d,e,f){b=[];for(var g=0;g<e.length;g++)b[g]=Md(a,e[g],d,x(f)?f[g]:l);c(b)};u.Bb=function(a,b,c,d,e,f){b=[];for(var g=0;g<e.length;g++)b[g]=Md(a,e[g],d,x(f)?f[g]:l);c(b)};u.Wa=function(a,b,c,d,e){c(Nd(a,d,e))};u.wb=function(a,b,c,d,e){b=[];for(var f=0;f<e.length;f++){var g=Nd(a,d,e[f]);b.push(g)}c(b)};u.Ja=aa();
u.xb=function(a,b,c,d){b=[];for(var e=0;e<d.length;e++){var f=Nd(a,d[e].a,d[e].id);b.push(f)}c(b)};u.Ia=aa();u.Cb=function(a,b,c,d,e){Od(a,d,e);c(p)};u.Ra=function(a,b,c,d){for(b=0;b<d.length;b++)Od(a,d[b]);c(p)};u.Ta=function(a,b,c,d){Kd(function(){for(var b=[],f=0;f<d.length;f++){var g=a.Xa(d[f]);b[f]=g.length}c(b)},0,this)};u.oa=function(a,b,c,d){b="_database_"+this.pa;x(d)&&(b+="-"+d);d=0;for(var e in a)a.hasOwnProperty(e)&&0==e.lastIndexOf(b,0)&&d++;c(d)};E("ydn.async.all",function(a){for(var b=[],c,d=0;c=a[d];d++){var e=new M;c.success(na(function(a,b){N(a,b)},e));c.error(na(function(a,b){a.m(b)},e));b[d]=e}return new Sc(b)});function Pd(a,b,c){dd.call(this,a,b,c)}F(Pd,dd);u=Pd.prototype;u.d=U("ydn.db.crud.req.WebSql");function Qd(a,b){var c=a._default_?sa(a._default_):{};if(b.keyPath!=q){var d=Rd(a[b.keyPath],b.type,r);d!=q&&Sd(b,c,d)}for(d=0;d<b.indexes.length;d++){var e=b.indexes[d],f=e.b;"_default_"==f||e.c||(f=Rd(a[f],e.type,e.multiEntry),x(f)&&(c[e.name]=f))}return c}u.Yb=function(a,b,c,d,e,f,g,h){Td(this,a,b,c,p,d,l,e,f,g,h,r)};u.Xb=function(a,b,c,d,e,f,g,h,j,n){Td(this,a,b,c,p,d,e,f,g,h,j,n)};
function Td(a,b,c,d,e,f,g,h,j,n,m,s){var w=[],A=X(a.a,f),G=A.c,I=g!=q&&g!==G?Ud(A,g):q;f=!!I;var Da=L(g||G),S=f?I.type:A.type,ea=f&&I.multiEntry,I="*";e&&(I=L(G),g!=q&&g!=G&&(I+=", "+L(g)));g="SELECT "+(s?"DISTINCT":"")+I+" FROM "+Vd(A);s=[];h!=q&&(I=[],xa(Da,S,ea,h,I,s),g+=" WHERE "+I.join(" AND "));h=j?"DESC":"ASC";g+=" ORDER BY "+Da+" "+h;f&&(g+=", "+L(G)+" "+h);C(n)&&(g+=" LIMIT "+n);C(m)&&(g+=" OFFSET "+m);var W="TxNo:"+c+" SQL: "+g+" PARAMS: "+J(s);T(a.d,W);b.executeSql(g,s,function(b,c){for(var f=
0,g=c.rows.length;f<g;f++){var h=c.rows.item(f);e?w[f]=Rd(h[G],A.type,ea):h!=q&&(w[f]=Qd(h,A))}R(a.d,"success "+W);d(w)},function(b,c){Q(a.d,"error: "+W+c.message);d(c,p);return r})}u.nb=function(a,b,c,d,e,f){Wd(this,a,b,c,p,p,d,[e],[f])};u.Ab=function(a,b,c,d,e,f){Wd(this,a,b,c,r,p,d,[e],[f])};u.ob=function(a,b,c,d,e,f){Wd(this,a,b,c,p,r,d,e,f)};
function Wd(a,b,c,d,e,f,g,h,j){function n(b,g){var S;S=x(j)?Xd(m,h[b],j[b]):Xd(m,h[b]);var ea=s+Vd(m)+" ("+S.Qb.join(", ")+") VALUES ("+S.gc.join(", ")+");",W="TX"+c+" SQL: "+ea+" PARAMS: "+S.B+" REQ: "+b+" of "+h.length;T(a.d,W);g.executeSql(ea,S.B,function(c,e){A++;var g=x(S.key)?S.key:e.insertId;f?(R(a.d,"success "+G),d(g)):(w[b]=g,A==h.length?(R(a.d,"success "+G),d(w)):(g=b+2,g<h.length&&n(g,c)))},function(c,g){A++;if(6==g.code&&e)if(f)R(a.d,"success "+W),d(g,p);else if(w[b]=q,A==h.length)T(a.d,
"success "+G),d(w);else{var j=b+2;j<h.length&&n(j,c)}else Q(a.d,"error: "+g.message+" "+G),d(g,p);return r})}var m=X(a.a,g),s=e?"INSERT INTO ":"INSERT OR REPLACE INTO ",w=[],A=0,G="TX"+c+" inserting "+h.length+" objects.";if(0<h.length)for(g=0;2>g&&g<h.length;g++)n(g,b);else R(a.d,"success"),d([])}u.Bb=function(a,b,c,d,e,f){Wd(this,a,b,c,r,r,d,e,f)};
u.cc=function(a,b,c,d,e){if(0==e.length)c([]);else{for(var f=[],g=0,h=0,j=this,n=function(n,m){var s=[];T(j.d,"put "+m.length+" objects to "+n);for(var w,A=(w=!!X(j.a,n).keyPath)?l:[],I=0;I<m.length;I++)s.push(d[m[I]]),w||A.push(e[m[I]].id);Wd(j,a,b,function(a,b){if(b)g++,g==h&&c(a,p);else{for(var d=0;d<m.length;d++)f[m[d]]=a[d];g++;g==h&&c(f)}},r,r,n,s,A)},m="",s=[],w=[],A=0;A<e.length;A++){var G=e[A].a,I=e[A].id;G!=m?(h++,0<s.length&&n(m,s),s=[A],w=[I],m=G):(s.push(A),w.push(I))}0<s.length&&n(m,
s)}};u.Wa=function(a,b,c,d,e){var f=X(this.a,d),g=this;d=f.a;e=[za(e,f.type,r)];d="SELECT * FROM "+Vd(f)+" WHERE "+d+" = ?";var h="TxNo"+b+" SQL: "+d+" PARAMS: "+e;T(this.d,h);a.executeSql(d,e,function(a,b){if(0<b.rows.length){var d=b.rows.item(0);d!=q?(d=Qd(d,f),c(d)):(R(g.d,"success: "+h),c(l))}else R(g.d,"success no result: "+h),c(l)},function(a,b){Q(g.d,"error: "+h+" "+b.message);c(b,p);return r})};
u.wb=function(a,b,c,d,e){function f(a,d){var w=n.a,A=[za(e[a],n.type,r)],G="SELECT * FROM "+Vd(n)+" WHERE "+w+" = ?";T(g.d,"SQL: "+G+" PARAMS: "+A);d.executeSql(G,A,function(d,s){j++;if(0<s.rows.length){var w=s.rows.item(0);w!=q&&(h[a]=Qd(w,n))}else h[a]=l;j==e.length?(R(g.d,"TxNo:"+b+"success "+G),c(h)):(w=a+10,w<e.length&&f(w,d))},function(d,n){j++;Q(g.d,"error: "+G+" "+n.message);if(j==e.length)R(g.d,"TxNo:"+b+"success "+G),c(h);else{var s=a+10;s<e.length&&f(s,d)}return r})}var g=this,h=[],j=0,
n=X(this.a,d);if(0<e.length)for(d=0;10>d&&d<e.length;d++)f(d,a);else R(g.d,"success"),c([])};u.Ja=function(a,b,c,d,e,f,g,h){Td(this,a,b,c,r,d,l,e,f,g,h,r)};u.Ia=function(a,b,c,d,e,f,g,h,j,n){Td(this,a,b,c,r,d,e,f,g,h,j,n)};
u.xb=function(a,b,c,d){function e(a,b){var m=d[a],s=X(f.a,m.a),w=y(m.id)?m.id.join("^|"):m.id,m=s.a,w=[za(w,s.type,r)],A="SELECT * FROM "+Vd(s)+" WHERE "+m+" = ?";T(f.d,"SQL: "+A+" PARAMS: "+w);b.executeSql(A,w,function(b,n){h++;if(0<n.rows.length){var m=n.rows.item(0);m!=q&&(g[a]=Qd(m,s))}else g[a]=l;h==d.length?(T(f.d,"success "+A),c(g)):(m=a+10,m<d.length&&e(m,b))},function(a,b){Q(f.d,"error: "+A+" "+b.message);c(b,p);return r})}var f=this,g=[],h=0;if(0<d.length)for(b=0;10>b&&b<d.length;b++)e(b,
a);else T(this.d,"success"),c([])};u.Ra=function(a,b,c,d){function e(a,b){var j="DELETE FROM  "+Vd(X(f.a,d[a]));T(f.d,"SQL: "+j+" PARAMS: []");b.executeSql(j,[],function(b){a==d.length-1?(T(f.d,"success "+j),c(d.length)):e(a+1,b)},function(a,b){Q(f.d,"error: "+j+" "+b.message);c(b,p);return r})}var f=this;0<d.length?e(0,a):(T(this.d,"success"),c(0))};
u.Cb=function(a,b,c,d,e){d=X(this.a,d);e=za(e,d.type,r);var f=this;d="DELETE FROM "+Vd(d)+" WHERE "+d.a+" = ?";var g="TX"+b+" SQL: "+d+" PARAMS: "+[e];T(this.d,g);a.executeSql(d,[e],function(a,b){T(f.d,"success "+g);c(b.rowsAffected)},function(a,b){Q(f.d,"error: "+g+b.message);c(b,p);return r})};u.Pb=function(a,b,c,d,e){Yd(this,a,b,c,d,l,e)};u.ec=function(a,b,c,d,e){Yd(this,a,b,c,d,l,e)};u.dc=function(a,b,c,d,e,f){Yd(this,a,b,c,d,e,f)};
function Yd(a,b,c,d,e,f,g){var h=X(a.a,e);e="DELETE FROM "+Vd(h);var j=[];if(g!=q){var n=[];x(f)?(f=Ud(h,f),xa(f.a,f.type,f.multiEntry,g,n,j)):xa(h.a,h.type,r,g,n,j);e+=" WHERE "+n.join(" AND ")}var m="TX"+c+" SQL: "+e+" PARAMS: "+j;T(a.d,m);b.executeSql(e,j,function(b,c){T(a.d,"success "+m);d(c.rowsAffected)},function(b,c){Q(a.d,"error: "+m+c.message);d(c,p);return r})}
u.Ta=function(a,b,c,d){function e(b){var j="SELECT COUNT(*) FROM "+L(d[b]);T(f.d,"SQL: "+j+" PARAMS: []");a.executeSql(j,[],function(a,m){var s=m.rows.item(0);g[b]=parseInt(s["COUNT(*)"],10);b++;T(f.d,b+". success "+j);b==d.length?c(g):e(b)},function(a,b){Q(f.d,"error: "+j+" "+b.message);c(b,p);return r})}var f=this,g=[];0==d.length?(T(this.d,"success"),c(0)):e(0);return c};
u.oa=function(a,b,c,d,e,f){var g=this,h="SELECT COUNT(*) FROM "+L(d),j=[],n=X(this.a,d);e!==q&&(d=[],x(f)?(f=Ud(n,f),xa(f.a,f.type,f.multiEntry,e,d,j)):xa(n.a,n.type,r,e,d,j),h+=" WHERE "+d.join(" AND "));var m="TX"+b+" SQL: "+h+" PARAMS: "+j;T(this.d,m);a.executeSql(h,j,function(a,b){var d=b.rows.item(0);T(g.d,"success "+m);c(d["COUNT(*)"])},function(a,b){Q(g.d,"error: "+m+b.message);c(b,p);return r});return c};var ae="serial parallel atomic-serial multirequest-serial samescope-multirequest-serial atomic-parallel multirequest-parallel samescope-multirequest-parallel open single".split(" ");function be(a){a?"abort"in a?a.abort():"executeSql"in a?a.executeSql("ABORT",[],aa(),ba(p)):k(new Aa):k(new Vc("No active transaction"))};/*
 _try.
*/
function ce(a,b){this.g=a;this.f=b;this.b=[];this.Ba=this.e=q;this.a=new de(b)}ce.prototype.c=U("ydn.db.tr.Serial");ce.prototype.a=q;ce.prototype.t=function(){return this.a.b};ce.prototype.h=function(){return this.a.a&&!this.a.c?this.a.a:q};E("ydn.db.tr.Serial.prototype.getTx",ce.prototype.h);u=ce.prototype;u.Ba=q;u.type=function(){return this.g.l()};u.Wb=ba(r);u.abort=function(){R(this.c,this+": aborting");be(this.Ba)};
u.ra=function(a,b,c,d){var e=a.name||"",f=B(b)?[b]:b;if(z(f)){0==f.length&&k(new K("number of store names must more than 0"));for(var g=0;g<f.length;g++)B(f[g])||k(new K("store name at "+g+" must be string but found "+f[g]+" of type "+typeof f[g]))}else k(new K("store names must be an array"));var h=x(c)?c:O,j=this;this.a.a||(!this.g.a||!this.g.a.fb())&&0<(this.e!==q)?(c=a,T(this.c,"Serial push tx queue "+c.name),this.b.push({ja:c,J:b,mode:h,I:d})):(this.e=d?[d]:[],this.g.transaction(function(c){var d=
j.a;d.a=c;d.c=r;d.J=b;d.mode=h;d.kb=e||"";d.b++;d.I=q;T(j.c,j+":tx"+j.a.b+J(b)+h+" begin");a(j);for(a=q;j.Wb();)c=j.b.shift(),c.I&&j.e.push(c.I),T(j.c,"pop tx queue in continue "+c.ja.name),c.ja()},f,h,function(a,b){T(j.c,j+":tx"+j.a.b+" committed with "+a);try{for(var c;c=j.e.shift();)c(a,b)}catch(d){k(d)}finally{if(c=j.a,c.a?(c.a=q,c.J=q,c.mode=q,ga(c.I)&&c.I(a,b),c.I=q):Q(c.Wc,c+" has no TX to be unlocked for "+a),c=j.b.shift())T(j.c,"pop tx queue of "+j.b.length+" "+c.ja.name),j.ra(c.ja,c.J,c.mode,
c.I)}}))};u.Lb=ba(r);u.j=function(a,b,c,d,e,f){d=d||O;var g=this,h=this.a;if(h.a&&!h.c&&this.Lb(c,d)){var j=h.a,n=function(b,c){g.Ba=j;c?a.m(b):N(a,b);n=g.Ba=q};b(j,g.t(),n);b=q}else{var m=function(){function c(b,e){g.Ba=d;e?a.m(b):N(a,b);c=g.Ba=q}h.a||k(new Uc("Tx not active for scope: "+e));h.c&&k(new Uc("Tx not available for scope: "+e));m.name=e;var d=h.a;b(d,g.t(),c);b=q};g.ra(m,c,d,f)}};u.getName=function(){return this.g.getName()};
u.toString=function(){var a;a="Serial:"+this.g.getName();var b=this.a.kb;return a+":"+this.f+":"+this.t()+(b?" ["+b+"]":"")};function ee(a,b){ce.call(this,a,b)}F(ee,ce);ee.prototype.c=U("ydn.db.tr.AtomicSerial");ee.prototype.j=function(a,b,c,d,e,f){var g,h,j=new M;j.C(function(a){h=r;g=a},function(a){h=p;g=a});ee.K.j.call(this,j,b,c,d,e,function(b,c){if(h===p)a.m(g);else if(h===r)N(a,g);else{var d=new bd;a.m(d)}f&&(f(b,c),f=l)})};function fe(a,b,c,d,e){x(e)||(e=y(a)?a.join(", "):a);a!=q&&(!B(a)&&!z(a))&&k(new K("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a));y(a)&&Object.freeze&&Object.freeze(a);!x(a)&&x(e)&&(a=e);this.keyPath=a;this.c=z(this.keyPath);this.name=e;this.type=ge(b);x(b)&&(x(this.type)||k(new K("type invalid in index: "+this.name)),y(this.keyPath)&&k(new K('composite key for store "'+this.name+'" must not specified type')));this.unique=!!c;this.multiEntry=!!d;this.e=B(this.type)?
this.type:he;this.b=B(e)?e:y(a)?this.keyPath.join(","):a;this.a=L(this.b)}var he="TEXT",ie=String.fromCharCode(31);function za(a,b,c){if(c)return y(a)?(b=x(b)?je(b):"b",a="d"==b?a.reduce(function(a,b){return a+ +b},""):"b"==b?a.reduce(function(a,b){return a+yb(b)},""):a.join(ie),b+ie+a+ie):"";if("DATE"==b){if(a instanceof Date)return+a}else return x(b)?a:yb(a)}
function Rd(a,b,c){if(c){if(B(a)){a=a.split(ie);var d=x(b)?je(b):a[0]instanceof Date?"d":C(a[0])?"n":B(a[0])?"t":"b";b=a.slice(1,a.length-1);return Va(b,function(a){return"d"==d?new Date(parseInt(a,10)):"b"==d?Bb(a):"n"==d?parseFloat(a):a})}}else return"DATE"==b?new Date(a):x(b)?a:Bb(a)}var ke=["BLOB","DATE","INTEGER","NUMERIC",he];function ge(a){if(B(a))return a=wa(ke,a),ke[a]}function je(a){return"DATE"===a?"d":"NUMERIC"===a?"n":a===he?"t":"b"}fe.prototype.getName=t("name");
fe.prototype.toJSON=function(){return{name:this.name,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};fe.prototype.Sa=function(){var a=y(this.keyPath)?ab(this.keyPath):this.keyPath;return new fe(a,this.type,this.unique,this.multiEntry,this.name)};function le(a,b){return a==q&&b==q?q:a!=q?b!=q?z(a)&&z(b)?db(a,b)?q:"expect: "+a+", but: "+b:me(a,b)?q:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b}
fe.prototype.hint=function(a){if(!a)return this;var b=y(this.keyPath)?ab(this.keyPath):this.keyPath,c=this.type;!x(a.type)&&"TEXT"==c&&(c=l);var d=this.multiEntry;a.multiEntry===p&&"TEXT"==this.type&&(d=p);return new fe(b,c,this.unique,d,a.name)};function ne(a,b,c,d,e,f,g){this.name=a;B(this.name)||k(new K("store name must be a string"));this.keyPath=x(b)?b:q;this.keyPath!==q&&(!B(this.keyPath)&&!z(this.keyPath))&&k(new K("keyPath must be a string or array"));this.autoIncrement=c;var h;x(d)&&(h=ge(d),x(h)||k(new K("type invalid in store: "+this.name)),y(this.keyPath)&&k(new K('composite key for store "'+this.name+'" must not specified type')));this.type=x(h)?h:this.autoIncrement?"INTEGER":l;this.b=B(this.keyPath)?this.keyPath.split("."):[];
this.indexes=e||[];this.ia=!!f;this.pc=!!g;this.e=B(this.type)?this.type:he;this.c=y(this.keyPath)?this.keyPath.join(","):B(this.keyPath)?this.keyPath:"_ROWID_";this.a=L(this.c)}u=ne.prototype;u.ia=r;u.pc=r;u.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.name,keyPath:this.keyPath,autoIncrement:this.autoIncrement,type:this.type,indexes:a}};
function oe(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync".split(" "),c;for(c in a)a.hasOwnProperty(c)&&-1==wa(b,c)&&k(new K('Unknown attribute "'+c+'"'));b=[];c=a.indexes||[];if(y(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f=["name","unique","type","keyPath","multiEntry"],g=l;for(g in e)e.hasOwnProperty(g)&&-1==wa(f,g)&&k(new K("Unknown field: "+g+" in "+J(e)));e=new fe(e.keyPath,e.type,e.unique,e.multiEntry,e.name);x(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new ne(a.name,
a.keyPath,a.autoIncrement,a.type,b,a.dispatchEvents,a.fixed)}u.Sa=function(){return oe(this.toJSON())};u.index=function(a){return this.indexes[a]||q};function Ud(a,b){return Xa(a.indexes,function(a){return a.name==b})}function pe(a,b){return b==a.keyPath?p:Wa(a.indexes,function(a){return a.name==b})}function Vd(a){return L(a.name)}
u.hint=function(a){if(!a)return this;var b=this.autoIncrement,c=y(this.keyPath)?ab(this.keyPath):this.keyPath,d=this.type,e=Va(this.indexes,function(a){return a.Sa()});!x(a.type)&&"TEXT"==d&&(d=l);y(a.keyPath)&&(B(c)&&c==a.keyPath.join(","))&&(c=ab(a.keyPath));for(var f=0,g=a.indexes.length;f<g;f++)if(a.indexes[f].c)for(var h=a.indexes[f].getName(),j=e.length-1;0<=j;j--)if(0<=h.indexOf(e[j].getName())){e[j]=a.indexes[f].Sa();break}for(f=0;f<e.length;f++)(g=Ud(a,e[f].getName()))&&(e[f]=e[f].hint(g));
return new ne(a.name,c,b,d,e)};u.getName=t("name");function qe(a,b){if(D(b)){if(z(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++)c[d]=b[a.keyPath[d]];return c}if(a.keyPath)return Jb(b,a.b)}}function Sd(a,b,c){for(var d=0;d<a.b.length;d++){var e=a.b[d];if(d==a.b.length-1){b[e]=c;break}x(b[e])||(b[e]={});b=b[e]}}
function Xd(a,b,c){var d=[],e=[];c=x(c)?c:qe(a,b);x(c)&&(e.push(a.a),d.push(za(c,a.type,r)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!(g.name===a.keyPath||"_default_"==g.name)){var h;h=g;var j=b;if(j!=q)if(z(h.keyPath)){for(var n=[],m=0,s=h.keyPath.length;m<s;m++){var w=wb(j,h.keyPath[m]);n[m]=w}h=n}else h=wb(j,h.keyPath);else h=l;h!=q&&(d.push(za(h,g.type,g.multiEntry)),e.push(g.a))}}if(!a.pc){var f={},A;for(A in b)b.hasOwnProperty(A)&&!pe(a,A)&&(f[A]=b[A]);d.push(J(f));e.push("_default_")}a=
[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Qb:e,gc:a,B:d,key:c}}
function re(a,b){if(!b)return"missing store: "+a.name;if(a.name!=b.name)return"store name, expect: "+a.name+", but: "+b.name;var c=le(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(x(a.autoIncrement)&&x(b.autoIncrement)&&a.autoIncrement!=b.autoIncrement)return"autoIncrement, expect:  "+a.autoIncrement+", but: "+b.autoIncrement;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(x(a.type)&&x(b.type)&&(z(a.type)?!db(a.type,b.type):
a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=Ud(b,a.indexes[c].name),e;e=a.indexes[c];if(d)if(e.name!=d.name)e="name, expect: "+e.name+", but: "+d.name;else{var f=le(e.keyPath,d.keyPath);e=f?"keyPath, "+f:e.unique!=q&&d.unique!=q&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:e.multiEntry!=q&&d.multiEntry!=q&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:x(e.type)&&x(d.type)&&
(z(e.type)?!db(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.name;if(0<e.length)return'index "'+a.indexes[c].name+'" '+e}return""};function se(a,b){var c,d=b;if(D(a)){c=["version","stores"];for(var e in a)a.hasOwnProperty(e)&&-1==wa(c,e)&&k(new K("Unknown field: "+e+" in schema."));c=a.version;d=[];e=a.stores||[];y(e)||k(new K("stores must be array"));for(var f=0;f<e.length;f++){var g=oe(e[f]);-1!=Ya(d,function(a){return a.name==g.name})&&k(new K('duplicate store name "'+g.name+'".'));d.push(g)}}else B(a)?c=0==a.length?l:parseFloat(a):C(a)&&(c=a);x(c)&&((!C(c)||0>c)&&k(new K("Invalid version: "+c+" ("+a+")")),isNaN(c)&&(c=l));
x(b)&&(!y(b)||0<b.length&&!(b[0]instanceof ne))&&k(new K("stores"));this.version=c;this.c=!x(this.version);this.stores=d||[]}se.prototype.toJSON=function(){var a=this.stores.map(function(a){return a.toJSON()});return{version:this.version,stores:a}};se.prototype.c=r;se.prototype.a=ba(r);function te(a){return a.stores.map(function(a){return a.name})}se.prototype.b=function(a){return this.stores[a]||q};function X(a,b){return Xa(a.stores,function(a){return a.name==b})}
function ue(a,b){return Wa(a.stores,function(a){return a.name==b})}function ve(a,b,c){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var d=0;d<a.stores.length;d++){var e=X(b,a.stores[d].name),e=e&&c?e.hint(a.stores[d]):e,e=re(a.stores[d],e);if(0<e.length)return'store: "'+a.stores[d].name+'" '+e}return""};function we(a,b){x(a)&&5242880<a&&Q(this.k,"storage size request ignored, use Quota Management API instead");this.n=q;this.Ma=b||NaN}
we.prototype.ta=function(a,b){function c(a,c,d){R(e.k,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)xe(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)ue(b,c[d])||(a.deleteObjectStore(c[d]),R(e.k,"store: "+c[d]+" deleted."))}function d(a,b){f.da?Q(e.k,"database already set."):x(b)?(Q(e.k,b?b.message:"Error received."),e.n=q,f.m(b)):(e.n=a,e.n.onabort=function(a){T(e.k,e+": onabort - "+a.message)},e.n.onerror=function(a){T(e.k,
e+": onerror - "+a.message)},e.n.onversionchange=function(a){T(e.k,e+": onversionchange to: "+a.version);e.n&&(e.n.onabort=q,e.n.onerror=q,e.n.onversionchange=q,e.n.close(),e.n=q,ga(e.b)&&e.b())},N(f,parseFloat(g)))}var e=this,f=new M,g=l,h=b.version;R(e.k,"Opening database: "+a+" ver: "+(b.c?"auto":h));var j;j=x(h)?ye.open(a,h):ye.open(a);j.onsuccess=function(f){var h=f.target.result;x(g)||(g=h.version);R(e.k,"Database: "+h.name+", ver: "+h.version+" opened.");if(b.c)e.W(function(f){if(b.a())for(var g=
0;g<f.stores.length;g++)if(!ue(b,f.stores[g].getName())){var j=f.stores[g].Sa();b.stores.push(j)}f=ve(b,f);if(0<f.length){R(e.k,"Schema change require for difference in "+f);var n=C(h.version)?h.version+1:1;if("IDBOpenDBRequest"in v){h.close();var s=ye.open(a,n);s.onupgradeneeded=function(a){a=a.target.result;R(e.k,"re-open for version "+a.version);c(a,s.transaction,r)};s.onsuccess=function(a){d(a.target.result)};s.onerror=function(){R(e.k,e+": fail.");d(q)}}else{var S=h.setVersion(n+"");S.a=function(a){Q(e.k,
"migrating from "+h.version+" to "+n+" failed.");d(q,a)};S.onsuccess=function(){S.transaction.oncomplete=ea;c(h,S.transaction,p)};var ea=function(){var b=ye.open(a);b.onsuccess=function(a){a=a.target.result;R(e.k,e+": OK.");d(a)};b.onerror=function(){R(e.k,e+": fail.");d(q)}};S.transaction!=q&&(S.transaction.oncomplete=ea)}}else d(h)},l,h);else if(b.version>h.version){var j=h.setVersion(b.version);j.a=function(a){Q(e.k,"migrating from "+h.version+" to "+b.version+" failed.");d(q,a)};j.onsuccess=function(){c(h,
j.transaction,p)}}else b.version==h.version?R(e.k,"database version "+h.version+" ready to go"):Q(e.k,"connected database version "+h.version+" is higher than requested version."),e.W(function(a){a=ve(b,a);0<a.length?(R(e.k,a),d(q,new hd("different schema: "+a))):d(h)},l,h)};j.onupgradeneeded=function(a){a=a.target.result;g=NaN;R(e.k,"upgrade needed for version "+a.version);c(a,j.transaction,r)};j.onerror=function(c){Ec(e.k,"opening database "+a+":"+b.version+" failed.");d(q,c)};j.onblocked=function(c){Ec(e.k,
"database "+a+" "+b.version+" block, close other connections.");d(q,c)};C(this.Ma)&&!isNaN(this.Ma)&&Kd(function(){"done"!=j.readyState&&(Ec(e.k,e+": database state is still "+j.readyState),d(q,new bd("connection timeout after "+e.Ma)))},this.Ma);return f};var ye=v.indexedDB||v.mozIndexedDB||v.webkitIndexedDB||v.moz_indexedDB||v.msIndexedDB;u=we.prototype;u.Ma=18E4;u.ua=ba("indexeddb");u.Gb=function(){return this.n||q};u.fb=function(){return!!this.n};u.k=U("ydn.db.con.IndexedDb");u.n=q;
u.Hb=function(){return this.n?parseFloat(this.n.version):l};
u.W=function(a,b,c){c=c||this.n;if(x(b)){if(b===q){if(0==c.objectStoreNames.length){a(new se(c.version));return}k(new gd)}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new se(c.version));return}b=c.transaction(b,O)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var h=b.objectStore(e[d]),j=[],n=0,m=h.indexNames.length;n<m;n++){var s=h.index(h.indexNames[n]);j[n]=new fe(s.keyPath,l,s.unique,s.multiEntry,s.name)}f[d]=new ne(h.name,
h.keyPath,h.autoIncrement,l,j)}b=new se(c.version,f);a(b)};
function xe(a,b,c,d){function e(){var a={autoIncrement:!!d.autoIncrement};d.keyPath!=q&&(a.keyPath=d.keyPath);try{return b.createObjectStore(d.getName(),a)}catch(c){"InvalidAccessError"==c.name&&k(new Wc("creating store for "+d.getName()+" of keyPath: "+d.keyPath+" and autoIncrement: "+d.autoIncrement)),"ConstraintError"==c.name&&k(new hd("creating store for "+d.getName())),k(c)}}T(a.k,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName()))if(c=
c.objectStore(d.getName()),(d.keyPath||"")!=(c.keyPath||""))b.deleteObjectStore(d.getName()),Q(a.k,"store: "+d.getName()+" deleted due to keyPath change."),c=e();else if(fa(c.autoIncrement)&&fa(d.autoIncrement)&&c.autoIncrement!=d.autoIncrement)b.deleteObjectStore(d.getName()),Q(a.k,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e();else{for(var f=c.indexNames,g=0,h=0,j=0;j<d.indexes.length;j++){var n=d.indexes[j];if(!f.contains(n.name)){if(n.unique||n.multiEntry){var m={unique:n.unique,
multiEntry:n.multiEntry};c.createIndex(n.name,n.keyPath,m)}else c.createIndex(n.name,n.keyPath);g++}}for(j=0;j<f.length;j++)pe(d,f[j])||(c.deleteIndex(f[j]),h++);T(a.k,"Updated store: "+c.name+", "+g+" index created, "+h+" index deleted.")}else{c=e();for(j=0;j<d.indexes.length;j++)n=d.indexes[j],T(a.k,"Creating index: "+n.name+" multiEntry: "+n.multiEntry),n.unique||n.multiEntry?(m={unique:n.unique,multiEntry:n.multiEntry},c.createIndex(n.name,n.keyPath,m)):c.createIndex(n.name,n.keyPath);T(a.k,"Created store: "+
c.name+" keyPath: "+c.keyPath)}}u.Ua=function(a,b,c,d){var e=this.n;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(q):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onerror=function(a){d("error",a)},b.onabort=function(a){d("abort",a)},a(b),a=q)};u.eb=function(){this.n.close()};u.toString=function(){return this.ua()+":"+(this.n?this.n.name+":"+this.n.version:"")};function ze(a){this.a=x(a)?a:4194304}u=ze.prototype;
u.ta=function(a,b){function c(a,b){x(b)?(d.A=q,f.m(b)):(d.A=a,N(f,parseFloat(e)))}var d=this,e=NaN,f=new M,g=q;try{g=v.openDatabase(a,"",a,this.a)}catch(h){"SECURITY_ERR"==h.name?(Q(this.o,"SECURITY_ERR for opening "+a),g=q,this.Ib=new $c(h)):k(h)}if(g){var e=g.version,j="database "+a+(0==g.version.length?"":" version "+g.version);b.version!=q&&b.version==g.version?(Fc(d.o,"Existing "+j+" opened as requested."),c(g)):this.W(function(e){if(e=ve(b,e,p)){0==g.version.length?Fc(d.o,"New "+j+" created."):
b.c?Fc(d.o,"Existing "+j+" opened and  schema change for "+e):Fc(d.o,"Existing "+j+" opened and  schema change to version "+b.version+" for "+e);var f=g;e=f.version?parseInt(f.version,10):0;e=b.c?isNaN(e)?1:e+1:b.version;T(d.o,a+": changing version from "+f.version+" to "+e);var h=r,w=0;f.changeVersion(f.version,e+"",function(a){d.W(function(c){h=p;for(var e=0;e<b.stores.length;e++){var f=X(c,b.b(e).getName()),f=f?f.hint(b.b(e)):q;Ae(d,a,b.b(e),function(a){a&&w++},f)}if(b instanceof Be)for(e=0;e<
c.stores.length;e++)f=c.b(e),ue(b,f.getName())||b.stores.push(f)},a,f)},function(a){k(a)},function(){if(h){var e=".";w!=b.stores.length&&(e=" but unexpected stores exists.");T(d.o,a+":"+f.version+" ready"+e);c(f)}else Q(d.o,a+": changing version voided.")})}else Fc(d.o,"Existing "+j+" with same schema opened."),c(g)},q,g)}else c(q,this.Ib);return f};u.ua=ba("websql");u.Ib=q;u.A=q;u.Gb=function(){return this.A||q};u.o=U("ydn.db.con.WebSql");
u.Hb=function(){return this.A?parseFloat(this.A.version):l};
u.W=function(a,b,c){function d(a,b){k(b)}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var w;w="sql"in e?e.sql:l;T(f.o,"Parsing table schema from SQL: "+w);w=w.substr(w.indexOf("("),w.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g);for(var A=l,G,I=[],Da=r,S=r,ea=0;ea<w.length;ea++){var W=w[ea].match(/\w+|"[^"]+"/g),Qa=Va(W,function(a){return a.toUpperCase()}),W=Ma(W[0],'"'),ub=
ge(Qa[1]);-1!=Qa.indexOf("PRIMARY")&&-1!=Qa.indexOf("KEY")?(B(W)&&(!/^[\s\xa0]*$/.test(W)&&"_ROWID_"!=W)&&(A=W),G=ub,-1!=Qa.indexOf("AUTOINCREMENT")&&(Da=p)):"_default_"==W?S=p:(Qa=new fe(W,ub,"UNIQUE"==Qa[2]),I.push(Qa))}e=new ne(e.name,A,Da,G,I,l,!S);h.push(e)}}d=new se(g,h);a(d)}}var f=this,g=(c=c||this.A)&&c.version?parseFloat(c.version):l,g=isNaN(g)?l:g,h=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.W(a,b,c)},function(a){Ec(f.o,"opening tx: "+a.message);
k(a)},e)};
function Ae(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==h.length&&(d(p),d=q)},function(b,e){g++;g==h.length&&(d(r),d=q);k(new Zc(e,"Error creating table: "+c.name+" "+a))})}var g=0,h,j=c.e,n="CREATE TABLE IF NOT EXISTS "+Vd(c)+" (",m=c.a,n=n+(m+" "+j+" PRIMARY KEY ");c.autoIncrement&&(n+=" AUTOINCREMENT ");for(var n=n+" ,_default_ BLOB",j=[],m=[m],s=0,w=c.indexes.length;s<w;s++){var A=c.index(s),G="";A.unique&&(A.multiEntry?Q(a.o,'store "'+c.getName()+'" has both multiEntry and unique set true, but it is not supported under websql'):G=
" UNIQUE ");var I=A.a;-1==m.indexOf(I)&&(n+=", "+I+" "+A.e+G,m.push(I))}j.unshift(n+");");h=j;n="Create";if(e){e=re(c,e);if(0==e.length){T(a.o,"same table "+c.name+" exists.");d(p);d=q;return}n="Modify";Q(a.o,"table: "+c.name+" has changed by "+e+" additionallly TABLE ALTERATION is not implemented, dropping old table.");h.unshift("DROP TABLE "+L(c.name))}T(a.o,n+" table: "+c.name+": "+h.join(";"));for(a=0;a<h.length;a++)f(h[a])}u.fb=function(){return!!this.A};u.eb=aa();
u.Ua=function(a,b,c,d){function e(a){T(h.o,h+": Tx "+c+" request cause error.");d("error",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var h=this;this.A===q&&(a(q),d("error",this.Ib));c==O?this.A.readTransaction(g,e,f):c==tb?this.A.changeVersion(this.A.version,this.A.version+1+"",g,e,f):this.A.transaction(g,e,f)};var ya=ye&&ye.cmp?ma(ye.cmp,ye):Fb;function Ce(a,b,c,d){this.g=a;this.b=b;this.a=d;this.e=c;this.c=q}Ce.prototype.i=U("ydn.db.tr.DbOperator");Ce.prototype.t=function(){return this.a.t()};Ce.prototype.abort=function(){this.a.abort()};function Y(a){a.c||(a.c=a.g.yb(a.e));return a.c}Ce.prototype.toString=function(){return"TxStorage:"+this.g.getName()};function De(a,b,c,d){Ce.call(this,a,b,c,d)}F(De,Ce);u=De.prototype;u.i=U("ydn.db.crud.DbOperator");
u.va=function(a,b,c){var d=qb(),e=this,f,g,h;if(x(a))if(y(a)){(x(c)||x(b))&&k(new K("too many arguments."));f=a;for(b=0;b<f.length;b++)ue(this.b,f[b])||k(new K('store name "'+f[b]+'" at '+b+" not found."));R(this.i,"countStores: "+J(f));this.a.j(d,function(a,b,c){Y(e).Ta(a,b,c,f)},f,O,"countStores")}else B(a)?(ue(this.b,a)||k(new K('store name "'+a+'" not found.')),f=[a],B(b)?(g=b,h=ta(c)):D(b)||!x(b)?(x(c)&&k(new K("Invalid key range or index")),(a=va(b))&&k(new K("invalid key range: "+b+" "+a)),
h=ta(b)):k(new K("key range must be an object, but "+b+" of type "+typeof b+" found.")),R(this.i,"countKeyRange: "+f[0]+" "+(g?g:"")+J(h)),this.a.j(d,function(a,b,c){Y(e).oa(a,b,c,f[0],h,g)},f,O,"countKeyRange")):k(new K("Invalid store name or store names."));else{(x(c)||x(b))&&k(new K("too many arguments."));f=te(this.b);var j=new M;R(this.i,"countStores: "+J(f));this.a.j(d,function(a,b,c){Y(e).Ta(a,b,c,f)},f,O,"countStores");d.C(function(a){a=a.reduce(function(a,b){return b+a},0);N(j,a)},function(a){j.m(a)});
return j}return d};
u.wa=function(a,b){var c=this,d=qb();if(a instanceof cd){var e=a.a;if(!ue(this.b,e)){if(this.b.a())return ob(l);k(new K("Store: "+e+" not found."))}var f=a.id;R(this.i,"getById: "+e+":"+f);this.a.j(d,function(a,b,d){Y(c).Wa(a,b,d,e,f)},[e],O,"getById")}else if(B(a)&&x(b)){if(!X(this.b,a)){if(this.b.a())return ob(l);k(new K('Store name "'+a+'" not found.'))}if(b instanceof ua||b instanceof H){var g=new M;g.C(function(a){N(d,a[0])},function(a){d.m(a)});var h=va(b);h&&k(new K("invalid key range: "+b+
" "+h));var j=ta(b);R(this.i,"getById: "+a+":"+J(j));this.a.j(g,function(b,d,e){Y(c).Ja(b,d,e,a,j,r,1,0)},[a],O,"getById")}else R(this.i,"getById: "+a+":"+b),this.a.j(d,function(d,e,f){Y(c).Wa(d,e,f,a,b)},[a],O,"getById")}else k(new K("get require valid input arguments."));return d};
u.keys=function(a,b,c,d,e,f){var g=this,h,j,n=q,m=r,s=X(this.b,a);B(a)||k(new K("store name must be a string, but "+a+" of type "+typeof a+" is not."));this.b.a()||(s||k(new K('store name "'+a+'" not found.')),B(b)&&!Ud(s,b)&&k(new K('index "'+b+'" not found in store "'+a+'".')));if(this.b.a()&&!s)return ob([]);s=new M;if(B(b)){var w=va(c);w&&k(new K("invalid key range: "+c+" "+w));n=ta(c);C(d)?h=d:(x(d)&&k(new K("limit must be a number")),h=100);C(e)?j=e:(x(e)&&k(new K("offset must be a number")),
j=0);x(f)&&(fa?m=f:k(new K("reverse must be a boolean")));R(this.i,"keysByIndexKeyRange: "+a);this.a.j(s,function(c,d,e){Y(g).Xb(c,d,e,a,b,n,m,h,j,r)},[a],O,"keysByIndexKeyRange")}else(w=va(b))&&k(new K("invalid key range: "+b+" "+w)),n=ta(b),C(c)?h=c:(x(c)&&k(new K("limit must be a number")),h=100),C(d)?j=d:(x(d)&&k(new K("offset must be a number")),j=0),x(e)&&(fa(e)?m=e:k(new K("reverse must be a boolean"))),R(this.i,"keysByKeyRange: "+a),this.a.j(s,function(b,c,d){Y(g).Yb(b,c,d,a,n,m,h,j)},[a],
O,"keysByKeyRange");return s};
u.B=function(a,b,c,d,e,f){var g=this,h=qb(),j,n,m=r;if(B(a)){if(!X(this.b,a)){if(this.b.a())return ob([]);k(new Xc(a))}if(y(b))(x(c)||x(d))&&k(new K("too many input arguments")),R(this.i,"listByIds: "+a+" "+b.length+" ids"),this.a.j(h,function(c,d,e){Y(g).wb(c,d,e,a,b)},[a],O,"listByIds");else if(B(b)){var s=va(c);s&&k(new K("invalid key range: "+c+" "+s));var w=ta(c);x(d)?C(d)?j=d:k(new K("limit must be a number.")):j=100;x(e)?C(e)?n=e:k(new K("offset must be a number.")):n=0;fa(f)?m=f:x(f)&&k(new K("reverse must be a boolean, but "+
f));R(this.i,"listByIndexKeyRange: "+a+":"+b);this.a.j(h,function(c,d,e){Y(g).Ia(c,d,e,a,b,w,m,j,n,r)},[a],O,"listByIndexKeyRange")}else(s=va(b))&&k(new K("invalid key range: "+b+" "+s)),w=ta(b),x(c)?C(c)?j=c:k(new K("limit must be a number, but "+c+" is "+typeof c)):j=100,x(d)?C(d)?n=d:k(new K("offset must be a number, but "+d+" is "+typeof d)):n=0,x(e)&&(fa(e)?m=e:k(new K("reverse must be a boolean, but "+e+" is "+typeof e))),R(this.i,(w?"listByKeyRange: ":"listByStore: ")+a),this.a.j(h,function(b,
c,d){Y(g).Ja(b,c,d,a,w,m,j,n)},[a],O,"listByKeyRange")}else if(y(a))if(a[0]instanceof cd){c=[];for(d=0;d<a.length;d++){e=a[d].a;if(!ue(this.b,e)){if(this.b.a())return h=[],h[a.length-1]=l,ob(h);k(new K("Store: "+e+" not found."))}0<=wa(c,e)||c.push(e)}R(this.i,"listByKeys: "+J(c)+" "+a.length+" keys");this.a.j(h,function(b,c,d){Y(g).xb(b,c,d,a)},c,O,"listByKeys")}else k(new K("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found."));else k(new K("first argument "+a+" is invalid."));
return h};
u.gb=function(a,b,c){var d=B(a)?a:D(a)?a.name:l;B(d)||k(new K("store name "+d+" must be a string, but "+typeof d));var e=X(this.b,d);e?this.b.a()&&D(a)&&(a=oe(a),(a=re(e,a))&&k(new Aa("schema change: "+a))):(this.b.a()||k(new K('store name "'+d+'" not found.')),e=oe(D(a)?a:{name:d}),R(this.i,"Adding object store: "+d),Ee(this.g,e));a=qb();var f=this;e||k(new K('store name "'+d+'" not found.'));B(e.keyPath)&&x(c)&&k(new K("key cannot provide while in-line key is in used."));e.autoIncrement&&x(c)&&
k(new K("key cannot provide while autoIncrement is true."));!B(e.keyPath)&&(!e.autoIncrement&&!x(c))&&k(new K("out-of-line key must be provided."));if(y(b))R(this.i,"addObjects: "+d+" "+b.length+" objects"),this.a.j(a,function(a,e,g){Y(f).ob(a,e,g,d,b,c)},[d],P,"putObjects"),e.ia&&a.ba(function(a){Jd(f.g,new Fe(Ge,f.g,e.getName(),a,b))});else if(D(b)){var g="store: "+d+" key: "+!!e.keyPath?qe(e,b):c;R(this.i,"addObject: "+g);this.a.j(a,function(a,e,g){Y(f).nb(a,e,g,d,b,c)},[d],P,"putObject");e.ia&&
a.ba(function(a){Jd(f.g,new He(Ge,f.g,e.getName(),a,b))})}else k(new K("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found."));return a};
u.xa=function(a,b,c){var d=qb(),e=this;if(a instanceof cd){var d=a.a,f=X(this.b,d);f||k(new K('store "'+d+'" not found.'));if(f.keyPath){var g=qe(f,b);g!=q?0!=ya(g,a.id)&&k(new K("Inline key must be "+a+" but "+g+" found.")):Sd(f,b,a.id);return this.xa(d,b)}return this.xa(d,b,a.id)}if(y(a)){x(c)&&k(new K("too many arguments"));x(b)||k(new K("record values required"));for(var f=[],g=0,h=a.length;g<h;g++){var j=a[g].a;-1==wa(f,j)&&f.push(j);var n=X(this.b,j);n||k(new K('store "'+j+'" not found.'));
n.keyPath&&Sd(n,b[g],a[g].id)}R(this.i,"putByKeys: to "+J(f)+" "+b.length+" objects");this.a.j(d,function(c,d,f){Y(e).cc(c,d,f,b,a)},f,P,"putByKeys")}else if(B(a)||D(a)){f=B(a)?a:D(a)?a.name:l;B(f)||k(new K("store name must be a string"));(g=X(this.b,f))?this.b.a()&&D(a)&&(h=oe(a),(h=re(g,h))&&k(new Aa("schema change: "+h))):(this.b.a()||k(new Xc(f)),g=oe(D(a)?a:{name:f}),R(this.i,"Adding object store: "+f),Ee(this.g,g));g||k(new Xc(f));var n=g,m=n.getName();n.keyPath&&x(c)&&k(new K("key cannot provide while in-line key is in used."));
n.autoIncrement&&x(c)&&k(new K("key cannot provide while autoIncrement is true."));!n.keyPath&&(!n.autoIncrement&&!x(c))&&k(new K("out-of-line key must be provided."));y(b)?(R(this.i,"putObjects: "+m+" "+b.length+" objects"),this.a.j(d,function(a,d,f){Y(e).Bb(a,d,f,m,b,c)},[m],P,"putObjects"),n.ia&&d.ba(function(a){Jd(e.g,new Fe(Ie,e.g,m,a,b))})):D(b)?(R(this.i,"putObject: "+m+" "+c),this.a.j(d,function(a,d,f){Y(e).Ab(a,d,f,m,b,c)},[m],P,"putObject"),n.ia&&d.ba(function(a){Jd(e.g,new He(Ie,e.g,m,
a,b))})):k(new K("put record value must be Object or array of Objects"))}else k(new K("the first argument of put must be store name, store schema or array of keys."));return d};
u.clear=function(a,b,c){x(c)&&k(new K("too many input arguments"));c=qb();var d=this;if(B(a))if(X(this.b,a)||k(new K('store name "'+a+'" not found.')),D(b)){var e=ta(b);e===q&&k(new K("clear method requires a valid non-null KeyRange object."));R(this.i,"clearByKeyRange: "+a+":"+J(e));this.a.j(c,function(b,c,f){Y(d).Pb(b,c,f,a,e)},[a],P,"clearByKeyRange")}else x(b)&&k(new K("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+typeof b)),R(this.i,"clearByStore: "+
a),this.a.j(c,function(b,c,e){Y(d).Ra(b,c,e,[a])},[a],P,"clearByStores");else if(!x(a)||y(a)&&B(a[0])){var f=a||te(this.b);R(this.i,"clearByStores: "+J(f));this.a.j(c,function(a,b,c){Y(d).Ra(a,b,c,f)},f,P,"clearByStores")}else k(new K('first argument "'+a+'" is invalid.'));return c};
u.hb=function(a,b,c){var d=qb(),e=this;if(B(a)){var f=X(this.b,a);f||k(new K('store name "'+a+'" not found.'));if(x(c))if(B(b)){var g=Ud(f,b);g||k(new K("index: "+b+" not found in "+a));if(D(c)||c===q){var h=ta(c);R(this.i,"removeByIndexKeyRange: "+a+":"+g.getName()+" "+a);this.a.j(d,function(b,c,d){Y(e).dc(b,c,d,a,g.getName(),h)},[a],P,"removeByIndexKeyRange")}else k(new K("key range "+c+' is invalid type "'+typeof c+'".'))}else k(new K('index name "'+b+'" must be a string, but '+typeof b+" found."));
else B(b)||C(b)||b instanceof DOMStringList||y(b)||b instanceof Date?(R(this.i,"removeById: "+a+":"+b),this.a.j(d,function(c,d,f){Y(e).Cb(c,d,f,a,b)},[a],P,"removeById"),f.ia&&d.ba(function(b){Jd(e.g,new He(Je,e.g,a,b,l))})):D(b)?(h=ta(b),R(this.i,"removeByKeyRange: "+a+":"+J(h)),this.a.j(d,function(b,c,d){Y(e).ec(b,c,d,a,h)},[a],P,"removeByKeyRange"),f.ia&&d.ba(function(b){Jd(e.g,new Fe(Je,e.g,a,b,l))})):k(new K('Invalid key or key range "'+b+'" of type '+typeof b))}else k(new K('store name required, but "'+
a+'" of type '+typeof a+" found."));return d};u.toString=function(){return"DbOperator:"+this.g.getName()};E("ydn.db.con.IStorage.prototype.transaction",aa().prototype.transaction);function Ke(a,b,c,d){"transaction"in a?(this.q=a,this.f=this.l=q):"objectStore"in a?(this.q=q,this.l=a.db,this.f=a,this.f.db.objectStoreNames.contains(b)||k(new ed('store "'+b+'" not in transaction.'))):k(new ed("storage instance require."));this.G=b;this.ea=c;this.fa=d;this.e=[];this.c=0;this.h=r}Ke.prototype.b=U("ydn.db.con.IdbCursorStream");Ke.prototype.h=r;Ke.prototype.e=[];function Le(a,b,c){D(a)&&"transaction"in a?(this.Pa=a,this.ha=q):D(a)&&"db"in a?(this.Pa=q,Me(this,a)):k(new K("ydn.db.Streamer: First argument requires storage or transaction instance required."));B(b)||k(new K("a store name required."));this.a=b;x(c)&&!B(c)&&k(new K("index name must be a string."));this.sa=c;this.ha=q;this.Z=[];this.ma=[];this.Ga=r}u=Le.prototype;u.Pa=q;u.g=q;u.Fb=q;u.ma=[];u.Z=[];u.ha=q;u.fc=function(a){this.Fb=a};
function Me(a,b){"db"in b?a.ha=new Ke(b,a.a,a.sa,ma(a.ca,a)):k(new K("Invalid IndexedDB Transaction."))}function Ne(a){var b=0<a.Z.length;if(b&&!a.Ga&&ga(a.Fb)){var c=function(){Ne(a)},d=a.ma.shift(),e=a.Z.shift(),b=0<a.Z.length,c=a.Fb(d,e,b?c:q);b&&!c&&Ne(a)}}u.Ga=r;u.uc=function(a){if(this.ha){this.Ga=p;var b=this,c=this.ha,d=function(){a(b.ma,b.Z);b.ma=[];b.Z=[];b.Ga=r};0==c.e.length&&0==c.c?d():c.ca=d}else a(this.ma,this.Z),this.ma=[],this.Z=[]};
u.ca=function(a,b){this.ma.push(a);this.Z.push(b);Ne(this)};
u.push=function(a,b){this.Ga&&k(new Rc("push not allowed after a collection is started"));if(2<=arguments.length)this.ca(a,b);else{if(!this.ha){this.Pa||k(new Rc("Database is not setup."));var c=this.Pa.l();c?"indexeddb"===c?this.ha=new Ke(this.Pa,this.a,this.sa,ma(this.ca,this)):k(new fd(c)):k(new Rc("Database is not connected."))}var d=this.ha;d.e.push(a);if(!d.h){var e=function(a,b){d.f=q;"complete"!==a&&Q(d.b,b.name+":"+b.message);T(d.b,d+" transaction "+a)},f=function(a){var b=d.e.shift();T(d.b,
d+" transaction started for "+b);var c=a.objectStore(d.G).openCursor(b);d.c++;c.onsuccess=function(a){if(a=a.target.result){if(ga(d.fa)){var b=a.value;d.fa(a.primaryKey,d.ea!=q?b[d.ea]:b)}else Q(d.b,"sink gone, dropping value for: "+a.primaryKey);if(a&&0<d.e.length)a["continue"](d.e.shift());else d.c--,0==d.c&&d.ca&&d.ca()}};c.onerror=function(){Q(d.b,"seeking fail. "+("error"in c?c.error.name+":"+c.error.message:""));d.c--;0==d.c&&d.ca&&d.ca()}};d.f?(T(d.b,d+" using existing tx."),f(d.f)):d.l?(T(d.b,
d+" creating tx from IDBDatabase."),d.a=d.l.transaction([d.G],O),d.a.oncomplete=function(a){e("complete",a)},d.a.onerror=function(a){e("error",a)},d.a.onabort=function(a){e("abort",a)}):d.q?(T(d.b,d+" creating tx from ydn.db.con.IStorage."),d.h=p,d.q.transaction(function(a){d.h=r;f(a)},[d.G],O,e)):k(new gd("no way to create a transaction provided."))}}};u.Da=t("sa");u.toString=function(){return"Streamer:"+this.a+(this.sa||"")};function Oe(a,b,c,d,e,f,g){md.call(this);this.jb=c;this.e=d;this.f=B(this.e);this.H=e;this.a=a;this.G=b;this.reverse="prev"==f||"prevunique"==f;this.X=f;this.Za=g}F(Oe,md);u=Oe.prototype;u.jb="";u.X="";u.H=q;u.reverse=r;u.Za=p;u.V=function(a){k(a)};u.oc=function(){return this.f?this.Jb():this.r()};u.v=function(a,b,c){this.u(a,b,c)};u.u=aa();u.U=r;u.qa=function(){this.a=q};
u.toString=function(){var a="";this.Y()&&(a=this.f?" {"+this.oc()+":"+this.r()+"} ":" {"+this.r()+"} ");return(this.a?"":"~")+" TX"+this.G+" Cursor:"+a+this.jb+(x(this.e)?":"+this.e:"")};function Pe(a,b){a!=q&&!("push"in a)&&k(new ed);this.a=a||q;this.h=b;this.f=0}Pe.prototype.l=U("ydn.db.algo.AbstractSolver");Pe.prototype.a=q;Pe.prototype.b=function(a){y(a)||k(new TypeError("iterators must be array"));2>a.length&&k(new RangeError("ZigzagMerge require at least 2 iterators, but  only "+a.length+" found."));for(var b=0;b<a.length;b++)a[b]instanceof V||k(new TypeError("item at iterators "+b+" is not an iterator."));return r};Pe.prototype.c=function(){return[]};function Qe(a,b,c,d,e,f,g){Oe.call(this,a,b,c,d,e,f,g);this.Q=this.L=this.p=q;this.$=r}F(Qe,Oe);u=Qe.prototype;u.za=U("ydn.db.index.req.IDBCursor");u.p=q;
u.Cc=function(a){var b="IDB"+this;if(this.p=a=a.target.result){if(this.Q!=q){b=ye.cmp(a.key,this.Q);if(1===b){this.Q=this.L=q;this.v(a.primaryKey,a.key,a.value);return}if(0===b)this.Q=q;else{a["continue"]();return}}if(this.L!=q)if(b=ye.cmp(this.L,a.primaryKey),0===b)this.L=q,this.$?(this.$=r,a["continue"]()):this.v(a.primaryKey,a.key,a.value);else if(1===b)a["continue"]();else this.L=q,this.v(a.primaryKey,a.key,a.value);else this.v(a.primaryKey,a.key,a.value)}else this.L=this.Q=q,this.$=r,T(this.za,
b+" completed."),this.v(l,l,l)};u.L=q;u.Q=q;u.$=r;
u.ya=function(a,b,c){var d="IDB"+this;this.L=a;this.Q=b;this.$=!!c;a=this.H;if(b!=q)if(this.H!=q){a=ye.cmp(b,this.H.lower);if(this.reverse&&1==a){T(this.za,d+" not opened, index key in reverse out of range "+b+">"+this.H.lower);this.u(l,l,l);return}if(!this.reverse&&-1==a){T(this.za,d+" not opened, index key out of range "+b+"<"+this.H.lower);this.u(l,l,l);return}a=ua.bound(b,this.H.upper,r,this.H.upperOpen)}else a=ua.lowerBound(b);b=this.a.objectStore(this.jb);c=this.e?b.index(this.e):q;T(this.za,
d+" opening ");b=this.Za?c?this.X!=q?c.openKeyCursor(a,this.X):a!=q?c.openKeyCursor(a):c.openKeyCursor():this.X!=q?b.openCursor(a,this.X):a!=q?b.openCursor(a):b.openCursor():c?this.X!=q?c.openCursor(a,this.X):a!=q?c.openCursor(a):c.openCursor():this.X!=q?b.openCursor(a,this.X):a!=q?b.openCursor(a):b.openCursor();R(this.za,d+" opened, request "+b.readyState);b.onsuccess=ma(this.Cc,this);b.onerror=ma(this.V,this)};u.Y=function(){return!!this.p};u.Jb=function(){return this.p.key};u.r=function(){return this.p.primaryKey};
u.ib=function(){return this.p.value};u.Kb=function(a){if(this.p){var b=new M;a=this.p.update(a);a.onsuccess=function(a){N(b,a.target.result)};a.onerror=function(a){b.m(a)};return b}k(new Wc("cursor gone"))};u.clear=function(){if(this.p){var a=new M,b=this.p["delete"]();b.onsuccess=function(){N(a,1)};b.onerror=function(b){a.m(b)};return a}k(new Wc("cursor gone"))};u.cb=function(a,b){T(this.za,this+" restarting.");this.ya(b,a,p)};
u.advance=function(a){this.p||k(new Rc(this+" cursor gone."));this.L=this.Q=q;this.$=r;if(1==a)this.p["continue"]();else this.p.advance(a)};u.Ca=function(a){this.p||k(new Rc(this+" cursor gone."));this.f?(this.Q=q,this.L=a,this.$=r,this.p["continue"]()):(this.L=this.Q=q,this.$=r,this.p["continue"](a))};u.D=function(a){this.p||k(new Rc(this+" cursor gone."));this.L=this.Q=q;this.$=r;if(a!=q)this.p["continue"](a);else this.p["continue"]()};u.qa=function(){Qe.K.qa.call(this);this.p=q};function Re(a,b,c){dd.call(this,a,b,c)}F(Re,kd);Re.prototype.d=U("ydn.db.index.req.IndexedDb");Re.prototype.e=function(a,b,c,d,e,f){var g=[],h="TX"+b+" keysByIterator:"+d,j=this;T(this.d,h);var n=Qc(d,a,b,this);n.V=function(a){Q(j.d,"error:"+h);Pc(d);n.s();c(a,p)};var m=0,s=r;n.u=function(a,b){x(a)?!s&&0<f?(n.advance(f),s=p):(m++,g.push(n.f?b:a),!x(e)||m<e?n.D():(Pc(d),n.s(),T(j.d,"success:"+h),c(g))):(Pc(d),n.s(),T(j.d,"success:"+h),c(g))}};
Re.prototype.c=function(a,b,c,d,e,f){var g=[],h="TX"+b+" listByIterator"+d,j=this;T(this.d,h);var n=Qc(d,a,b,this);n.V=function(a){R(j.d,"error:"+h);Pc(d);n.s();c(a,r)};var m=0,s=r;n.u=function(a,b,G){x(b)?!s&&0<f?(n.advance(f),s=p):(m++,g.push(d.R?a:G),!x(e)||m<e?n.D():(Pc(d),R(j.d,"success:"+h),n.s(),c(g))):(Pc(d),T(j.d,"success:"+h),n.s(),c(g))}};Re.prototype.b=function(a,b,c,d,e,f,g){return new Qe(a,b,c,d,e,f,g)};function Se(a,b,c,d,e,f,g,h){Oe.call(this,a,b,d,e,f,g,h);this.b=c;this.T=0}F(Se,Oe);u=Se.prototype;u.na=U("ydn.db.index.req.WebsqlCursor");u.Fa=q;u.T=NaN;u.Jb=t("h");u.r=t("c");u.ib=t("l");
function Te(a,b){var c=["SELECT"],d=[],e=a.b.c,f=L(e),g=B(a.e)?Ud(a.b,a.e):q,h=!!g,j=g?g.type:a.b.type,n=g?g.b:e,m=L(n),s=" ORDER BY ";a.Za?h?(c.push(L(n)+", "+f),s+=a.reverse?L(n)+" DESC, "+f+" DESC ":L(n)+" ASC, "+f+" ASC "):(c.push(f),s=s+f+(a.reverse?" DESC":" ASC")):(c.push("*"),h?s+=a.reverse?L(n)+" DESC, "+f+" DESC ":L(n)+" ASC, "+f+" ASC ":(s+=f,s+=a.reverse?" DESC":" ASC"));c.push("FROM "+L(a.jb));var w=[],A=!!g&&g.multiEntry,G=a.H;g&&a.q!=q?(G=a.H!=q?ua.bound(a.q,a.H.upper,r,a.H.upperOpen):
ua.lowerBound(a.q),xa(m,j,A,G,w,d)):!g&&a.Fa!=q?(G=a.reverse?ua.upperBound(a.Fa,r):ua.lowerBound(a.Fa,r),xa(f,j,r,G,w,d)):xa(m,j,A,G,w,d);0<w.length&&c.push("WHERE "+w.join(" AND "));c.push(s);c.push("LIMIT 1");0<a.T&&c.push("OFFSET "+a.T);a.U=p;c=c.join(" ");T(a.na,a+": move:  SQL: "+c+" : "+J(d));a.a.executeSql(c,d,function(c,d){a.U=r;a.h=l;a.c=l;a.l=l;if(0<d.rows.length){var f=d.rows.item(0);a.c=Rd(f[e],a.b.type,r);a.h=h?Rd(f[n],j,A):a.c;a.l=a.Za?l:Qd(f,a.b)}b.call(a,a.c,a.h,a.l);b=q},function(c,
d){a.U=r;Q(a.na,"get error: "+d.message);a.V(d);a.h=l;a.c=l;a.l=l;b.call(a,a.c,a.h,a.l);b=q;return r})}u.Y=function(){return!!this.a&&0<=this.T};
u.Kb=function(a,b){this.Y()||k(new Wc);b&&k(new fd);var c=new M,d=this;this.U=p;var e=this.r(),f=Xd(d.b,a,e),g="REPLACE INTO "+Vd(this.b)+" ("+f.Qb.join(", ")+") VALUES ("+f.gc.join(", ")+") ON CONFLICT FAIL";T(d.na,this+': clear "'+g+'" : '+J(f.B));this.a.executeSql(g,f.B,function(){d.U=r;N(c,e)},function(a,b){d.U=r;Q(d.na,"get error: "+b.message);c.m(b);return r});return c};u.advance=function(a){this.T+=a;Te(this,this.v)};
u.D=function(a){this.Y()||k(new Rc(this+" cursor gone."));a!=q?this.f?this.q=a:this.Fa=a:this.T++;Te(this,this.v)};u.ya=function(a,b,c){this.Fa=a;this.q=b;c&&this.T++;Te(this,this.v)};
u.clear=function(a){this.Y()||k(new Wc);a&&k(new fd);var b=new M,c=this;this.U=p;a=this.b.c;a="DELETE FROM "+Vd(this.b)+" WHERE "+a+" = ?";var d=[this.r()];T(c.na,this+': clear "'+a+'" : '+J(d));this.a.executeSql(a,d,function(a,d){c.U=r;N(b,d.rowsAffected)},function(a,d){c.U=r;Q(c.na,"get error: "+d.message);b.m(d);return r});return b};u.cb=function(a,b){T(this.na,this+" restarting.");this.T=0;this.ya(b,a,r)};
u.Ca=function(a){this.Y()||k(new Rc(this+" cursor gone."));if(this.c!=q){var b=ya(a,this.c);(0==b||1==b&&this.reverse||-1==b&&!this.reverse)&&k(new Rc(this+' to continuePrimaryKey for "'+a+'" on '+this.X+" direction is wrong"));this.T++;Te(this,function(b,d,e){if(b!=q){var f=ya(a,b);0==f||1==f&&this.reverse||-1==f&&!this.reverse?this.v(b,d,e):this.Ca(a)}else this.v(l,l,l)})}else this.v(l,l,l)};U("ydn.db.index.req.CachedWebsqlCursor");function Ue(a,b,c){dd.call(this,a,b,c)}F(Ue,Pd);Ue.prototype.d=U("ydn.db.index.req.WebSql");Ue.prototype.e=function(a,b,c,d,e,f){Ve(this,a,b,c,d,p,e,f)};Ue.prototype.c=function(a,b,c,d,e,f){Ve(this,a,b,c,d,r,e,f)};
function Ve(a,b,c,d,e,f,g,h){var j=[],n="TX"+c+(f?" keys":" values")+"ByIterator "+e;T(a.d,n);var m=Qc(e,b,c,a);m.V=function(b){Q(a.d,"error:"+n);Pc(e);m.s();d(b,p)};var s=0,w=r;m.u=function(b,c,I){x(b)?!w&&0<h?(m.advance(h),w=p):(s++,j.push(f?m.f?c:b:e.R?b:I),!x(g)||s<g?m.D():(Pc(e),m.s(),T(a.d,"success:"+n),d(j))):(Pc(e),m.s(),T(a.d,"success:"+n),d(j))}}Ue.prototype.b=function(a,b,c,d,e,f,g){var h=X(this.a,c);return new Se(a,b,h,c,d,e,f,g)};function We(a,b,c){dd.call(this,a,b,c)}F(We,Ld);function Xe(a,b,c,d){Ce.call(this,a,b,c,d)}F(Xe,De);u=Xe.prototype;u.i=U("ydn.db.index.DbOperator");u.wa=function(a,b){var c=this;if(a instanceof V){var d=qb(),e=a.S,f=X(this.b,e);f||k(new K('store "'+e+'" not found.'));var g=a.Da();x(g)&&!pe(f,g)&&k(new K('index "'+g+'" not found in store "'+e+'".'));f=new M;f.C(function(a){N(d,a[0])},function(a){d.m(a)});R(this.i,"listByIterator:"+a);this.a.j(f,function(b,d,e){Y(c).c(b,d,e,a,1,0)},[e],O,"getByIterator");return d}return Xe.K.wa.call(this,a,b)};
u.keys=function(a,b,c,d,e){var f=this;if(a instanceof V){d=qb();var g=100;C(b)?(g=b,1>g&&k(new K("limit must be a positive value, but "+b))):x(b)&&k(new K("limit must be a number,  but "+b));var h=0;C(c)?h=c:x(c)&&k(new K("offset must be a number,  but "+c));R(this.i,"keysByIterator:"+a);this.a.j(d,function(b,c,d){Y(f).e(b,c,d,a,g,h)},a.stores(),O,"listByIterator");return d}return Xe.K.keys.call(this,a,b,c,d,e)};
u.va=function(a,b,c){var d=this;return a instanceof V?((x(b)||x(c))&&k(new K("too many arguments.")),b=qb(),R(this.i,"countKeyRange:"+a),this.a.j(b,function(b,c,g){Y(d).oa(b,c,g,a.S,a.M,a.Da())},a.stores(),O,"countByIterator"),b):Xe.K.va.call(this,a,b,c)};
u.B=function(a,b,c,d,e){var f=this;if(a instanceof V){d=qb();var g;C(b)?(g=b,1>g&&k(new K("limit must be a positive value, but "+g))):x(b)&&k(new K("limit must be a number, but "+b));var h;C(c)?h=c:x(c)&&k(new K("offset must be a number, but "+c));R(this.i,"listByIterator:"+a);this.a.j(d,function(b,c,d){Y(f).c(b,c,d,a,g,h)},a.stores(),O,"listByIterator");return d}return Xe.K.B.call(this,a,b,c,d,e)};
u.nc=function(a,b,c){var d=qb();y(a)||k(new TypeError("First argument must be array."));for(var e=0;e<a.length;e++){var f=a[e]instanceof Le;!(a[e]instanceof V)&&!f&&k(new TypeError("Iterator at "+e+" must be cursor range iterator or streamer."))}f=[];for(e=0;e<a.length;e++)for(var g=a[e].stores(),h=0;h<g.length;h++)0<=wa(f,g[h])||f.push(g[h]);T(this.i,this+": scan for "+a.length+" iterators on "+f);for(var j=c||[],e=0;e<j.length;e++)c=j[e].a,0<=wa(f,c)||f.push(c);var n=this;this.a.j(d,function(c,
d,e){function f(){for(var b=0,e=0;e<a.length;e++){var j=a[e],w=Qc(j,c,d,Y(n));w.V=g;w.u=na(h,b);jb[e]=w;ub[b]=e;b++;for(var w=0,A=j.La.length+1-1;w<A;w++){var Zd;Y(n);Zd=new Le(c,j.La[w],j.Ob[w]);Zd.fc(na(Da,b));Ob.push(Zd);Qa[b]=Ob.length;b++}}W=a.length+Ob.length}function g(b){for(var c=0;c<a.length;c++)Pc(a[c]);for(c=0;c<jb.length;c++)jb[c].s();Za(jb);Za(Ob);R(n.i,n+":tx"+d+": scanning error.");e(b,p)}function h(b,c,d,e){ea&&k(new gd);Pb++;var f=a[ub[b]];Mb[b]=f.c?d:c;mc[b]=f.R?c:e;b=Qa[b];c=0;
for(f=f.La.length+1-1;c<f;c++){var g=Ob[b+c],j=d,n=e;x(g.b)?g.push(n):g.push(j)}Pb===W&&S()}function Da(a,b,c){ea&&k(new gd);Mb[a]=b;mc[a]=c;Pb++;Pb===W&&S();return r}function S(){var c;c=b instanceof Pe?b.c(Mb,mc):b(Mb,mc);var f=[],g=[],h=[],j=[];if(y(c))for(var m=0;m<c.length;m++)c[m]===p?h[m]=1:c[m]===r?j[m]=p:g[m]=c[m];else if(c===q)f=[];else if(x(c))D(c)?(f=c.continuePrimary||[],g=c["continue"]||[],h=c.advance||[],j=c.restart||[]):k(new id("scan callback output"));else{f=[];for(m=0;m<a.length;m++)x(ub[m])&&
(h[m]=1)}for(m=Pb=c=0;m<a.length;m++)f[m]==q&&(g[m]==q&&j[m]==q&&h[m]==q)&&Pb++;for(m=0;m<a.length;m++)if(f[m]!=q||g[m]!=q||j[m]!=q||h[m]!=q){var A=ub[m];x(A)||k(new id(m+" is not an iterator."));var A=a[A],G=jb[m];Mb[m]==q&&(h[m]===p||g[m]!=q||f[m]!=q)&&k(new Rc(A+" at "+m+" must not advance."));Mb[m]=l;mc[m]=l;j[m]!=q?G.cb():g[m]!=q?G.D(g[m]):f[m]!=q?G.Ca(f[m]):h[m]!=q?G.advance(1):k(new gd(A+": has no action"));c++}if(0==c){for(f=0;f<a.length;f++)Pc(a[f]);for(f=0;f<jb.length;f++)jb[f].s();ea=p;
Za(jb);Za(Ob);R(n.i,n+":tx"+d+": scanning success.");e(l)}}T(n.i,n+":tx"+d+": scanning started.");for(var ea=r,W,Qa=[],ub=[],Mb=[],mc=[],jb=[],Ob=[],Pb=0,$d=0;$d<j.length;$d++)Me(j[$d],c);b instanceof Pe?b.b(a,function(){f()})||f():f()},f,O,"join");return d};
u.mc=function(a,b,c){a instanceof V||k(new K("First argument must be cursor range iterator."));X(this.b,a.S)||k(new K('Store "'+a.S+'" not found.'));c=c||O;var d=this,e=qb();R(this.i,"open:"+c+" "+a);this.a.j(e,function(c,e,h){var j=Qc(a,c,e,Y(d));j.V=function(b){Pc(a);j.s();h(b,p)};j.u=function(c){c!=q?(c=b(j),c===p?j.cb(q,q):D(c)?c.restart===p?j.cb(c["continue"],c.continuePrimary):c["continue"]!=q?j.D(c["continue"]):c.continuePrimary!=q?j.Ca(c.continuePrimary):(Pc(a),j.s(),h(l)):j.advance(1)):(Pc(a),
j.s(),h(l))}},a.stores(),c,"open");return e};u.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)e||k(new K('Store "'+e+'" not found.'));e=qb();T(this.i,"map:"+a);this.a.j(e,function(d,e,f){var n=Qc(a,d,e,Y(c));n.V=function(a){f(a,r)};n.u=function(c,d,e){c!=q?(b(a.R?a.c?d:c:a.c?c:e),n.advance(1)):(f(l),b=q)}},d,O,"map");return e};
u.reduce=function(a,b,c){for(var d=this,e=a.stores(),f,g=0;f=e[g];g++)f||k(new K('Store "'+f+'" not found.'));f=qb();var h=D(c)?sa(J(c)):c;R(this.i,"reduce:"+a);this.a.j(f,function(c,e,f){var g=Qc(a,c,e,Y(d));g.V=function(a){f(a,p)};var w=0;g.u=function(c,d,e){c!=q?(h=b(h,a.R?a.c?d:c:a.c?c:e,w++),g.advance(1)):f(h)}},e,O,"map");return f};function me(a,b){var c;c=c||{};if(a==q||b==q)return r;if(y(a)&&y(b)){if(a.length!=b.length)return r;for(var d=0;d<a.length;d++)if(-1==Xa(b,function(b){return me(b,a[d])}))return r;return p}if(y(a))return 1==a.length&&me(a[0],b);if(y(b))return 1==b.length&&me(b[0],a);if(D(a)&&D(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=me(a[e],b[e]);if(!f)return r}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=me(a[e],b[e]),!f))return r;return p}return a===b};function Ye(a){this.a=a}Ye.prototype.a=[];
Ye.prototype.b=function(a,b){for(var c=[],d=0;d<this.a.length;d++){var e=this.a[d],f="'"===e[0]&&"'"===e[e.length-1];if('"'===e[0]&&'"'===e[e.length-1])e=Jb(a,Ma(e,'"').split(".")),c.push(e);else if(f)c.push(Ma(e,"'"));else if(B(e))if("true"===e)c.push(p);else if("false"===e)c.push(r);else if("Date"===e)c.push(new Date(parseInt(c.pop(),10)));else if("now"===e)c.push(new Date);else if("!"===e)c[c.length-1]=!c[c.length-1];else if("=="===e)c.push(c.pop()==c.pop());else if("==="===e)c.push(c.pop()===
c.pop());else if("!="===e)c.push(c.pop()!=c.pop());else if("!=="===e)c.push(c.pop()!==c.pop());else if("<="===e)c.push(c.pop()<=c.pop());else if("<"===e)c.push(c.pop()<c.pop());else if(">="===e)c.push(c.pop()>=c.pop());else if(">"===e)c.push(c.pop()>c.pop());else if("&"===e)c.push(c.pop()&c.pop());else if("|"===e)c.push(c.pop()|c.pop());else if("?"===e){var e=!!c.pop(),f=c.pop(),g=c.pop(),e=e?f:g;c.push(e)}else"+"===e?c.push(c.pop()+c.pop()):"-"===e?c.push(c.pop()-c.pop()):"*"===e?c.push(c.pop()*
c.pop()):"/"===e?c.push(c.pop()/c.pop()):"%"===e?c.push(c.pop()%c.pop()):"at"===e?(f=c.pop(),e=c.pop(),c.push(e[f])):"of"===e?(f=c.pop(),e=c.pop(),e=y(e)?e.indexOf(f):-1,c.push(e)):"in"===e?(f=c.pop(),e=c.pop(),e=y(e)?0<=e.indexOf(f):r,c.push(e)):"abs"===e?c[c.length-1]=Math.abs(c[c.length-1]):"$"==e[0]&&/^\$\d$/.test(e)?(e=parseInt(e.match(/^\$(\d)$/)[1],10),c.push(arguments[e])):c.push(parseFloat(e));else c.push(e)}return c[0]};
Ye.prototype.c=function(){return function(){var a=2<arguments.length?Array.prototype.slice(arguments,2):l;return Ye.prototype.b.apply(q,a)}};Ye.prototype.toJSON=function(){return{Tokens:sa(J(this.a))}};function Ze(a){B(a)||k(new ed);this.P=a;$e(this,a);this.Na=""}u=Ze.prototype;u.P="";u.Oa=O;u.Zb=NaN;u.bc=NaN;u.Db=r;u.Na="";
function $e(a,b){var c=b.split(/\sFROM\s/i);2!=c.length&&k(new ad("FROM required."));var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);3!=c.length&&k(new ad("Unable to parse: "+b));a.c=c[1].toUpperCase();"SELECT"==a.c?a.Oa=O:"INSERT"==a.c?a.Oa=P:"UPDATE"==a.c?a.Oa=P:"DELETE"==a.c?a.Oa=P:k(new ad("Unknown SQL verb: "+a.c));var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.e=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.e=l;"("==c.charAt(0)&&
(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-1):new ad("missing closing parentheses"));a.q=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.a=d.substring(c),d=d.substring(0,c)):a.a="";c=d.search(/WHERE/i);0<c?(a.f=d.substring(c+6).trim(),d=d.substring(0,c)):a.f="";a.b=d.trim().split(",").map(function(a){a=Ma(a,'"');a=Ma(a,"'");return a.trim()})}
u.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.P=this.P.replace("?",a[b]);$e(this,this.P)}this.h=af(this);if(!this.h)return this.Na;a=this.a.length;if(b=/OFFSET\s+(\d+)/i.exec(this.a))this.bc=parseInt(b[1],10),a=this.a.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.a))this.Zb=parseInt(b[1],10),b=this.a.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.a.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.Db="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.Db=r,this.l=Ma(Ma(a,'"'),"'")):this.l=l;return""};function bf(a){if("*"==a.q)return q;a=a.q.split(",");return a=a.map(function(a){return Ma(a.trim(),'"')})}u.toJSON=function(){return{sql:this.P}};
function af(a){function b(a){return Ya(c,function(b){return b.aa==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.f.length)for(var e=a.f.split("AND"),f=0;f<e.length;f++){var g=e[f],h=d.exec(g);if(h){var j=h[1].trim(),j=Ma(j,'"'),j=Ma(j,"'");if(0<j.length){var n=h[3].trim(),n=0==n.lastIndexOf('"',0)?Ma(n,'"'):0==n.lastIndexOf("'",0)?Ma(n,"'"):parseFloat(n),h=new Hb(j,h[2],n),j=b(j);if(0<=j){if(c[j]=c[j].pb(h),!c[j])return a.Na='where clause "'+g+'" conflict',q}else c.push(h)}else return a.Na='Invalid clause "'+
g+'"',q}else return a.Na='Invalid clause "'+g+'"',q}return c}u.toString=function(){return"query:"+this.P};function cf(a,b){this.sql=b;this.a=a}cf.prototype.toJSON=function(){return{sql:this.sql}};cf.prototype.toString=ba("idb.Node:");
cf.prototype.qc=function(a,b,c,d){var e=ab(this.sql.b)[0],f=this.sql.h,g=this.sql.Zb,g=isNaN(g)?100:g,h=this.sql.bc,h=isNaN(h)?0:h,j=this.sql.l,n=bf(this.sql),m=q,s=this.sql.Db;0==f.length?m=q:1==f.length?m=ta(f[0].a):k(new Aa("too many conditions."));var w=c;n===q||(w=function(a,b){if(b)c(a,p);else{var d=a.map(function(a){var b=n.length;if(1==b)return wb(a,n[0]);for(var c={},d=0;d<b;d++)c[n[d]]=wb(a,n[d]);return c});c(d)}});j&&j!=this.a.keyPath?d.Ia(a,b,w,e,j,m,s,g,h,r):0<f.length&&f[0].aa!=this.a.keyPath?
d.Ia(a,b,w,e,f[0].aa,m,s,g,h,r):d.Ja(a,b,w,e,m,s,g,h)};function df(a,b){cf.call(this,a,b)}F(df,cf);
df.prototype.qc=function(a,b,c,d){var e,f=ab(this.sql.b)[0],g=this.sql.h,h=q;0==g.length?h=q:1==g.length?h=ta(g[0].a):k(new Aa("too many conditions."));var j=this.sql.e;if("COUNT"==j)h?d.oa(a,b,c,f,h,g[0].aa):d.oa(a,b,c,f,q);else{var n,m=bf(this.sql);(!m||0==m.length)&&k(new Rc("field name require for reduce operation: "+j));var s=m[0];"MIN"==j?n=function(a,b){var c=a[s];return!x(b)?c:b<c?b:c}:"MAX"==j?n=function(a,b){var c=a[s];return!x(b)?c:b>c?b:c}:"AVG"==j?(e=0,n=function(a,b,c){x(b)||(b=0);return(b*
c+a[s])/(c+1)}):"SUM"==j?(e=0,n=function(a,b){return b+a[s]}):k(new Aa(j));var w=Qc(h?new Nc(f,g[0].aa,h):new Mc(f),a,b,d);w.V=function(a){c(a,p)};var A=0;w.u=function(a,b,d){x(b)?(e=n(d,e,A),w.advance(1),A++):c(e)}}};function ef(a,b,c){dd.call(this,a,b,c)}F(ef,Re);ef.prototype.d=U("ydn.db.sql.req.IndexedDb");ef.prototype.executeSql=function(a,b,c,d,e){(e=d.parse(e))&&k(new ad(e));e=ab(d.b);if(1==e.length){var f=X(this.a,e[0]);f||k(new Xc(e[0]));var g=bf(d);if(g)for(var h=0;h<g.length;h++)pe(f,g[h])||k(new Xc('Index "'+g[h]+'" not found in '+e[0]));(d.e?new df(f,d):new cf(f,d)).qc(a,b,c,this)}else k(new Aa(d.P))};function ff(a,b){this.sql=b;this.c=a;this.a=bf(b)}ff.prototype.b=U("ydn.db.sql.req.websql.Node");ff.prototype.toJSON=function(){return{sql:this.sql.P}};ff.prototype.toString=ba("websql.Node:");function gf(a,b){if(a.a){if(1==a.a.length){if(D(b))return Jb(b,a.a[0]);return}for(var c={},d=0;d<a.a.length;d++)c[a.a[d]]=Jb(b,a.a[d]);return c}return Qd(b,a.c)}
ff.prototype.rc=function(a,b,c){var d=this,e=[];b.executeSql(this.sql.P,c,function(b,c){for(var h=c.rows.length,j=0;j<h;j++){var n=c.rows.item(j);if(D(n))var m=gf(d,n);e.push(m)}a(e)},function(b,c){Q(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function hf(a,b){ff.call(this,a,b)}F(hf,ff);hf.prototype.rc=function(a,b,c){var d=this;b.executeSql(this.sql.P,c,function(b,c){var d=c.rows.length;if(1==d){var h;a:{d=c.rows.item(0);for(h in d)if(d.hasOwnProperty(h)){h=d[h];break a}h=l}a(h)}else 0==d?a(l):k(new Uc)},function(b,c){Q(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function jf(a,b,c){dd.call(this,a,b,c)}F(jf,Ue);jf.prototype.d=U("ydn.db.sql.req.WebSql");jf.prototype.executeSql=function(a,b,c,d,e){b=ab(d.b);if(1==b.length){var f=X(this.a,b[0]);f||k(new Xc(b[0]));var g=bf(d);if(g)for(var h=0;h<g.length;h++)pe(f,g[h])||k(new Xc('Index "'+g[h]+'" not found in '+b[0]));(d.e?new hf(f,d):new ff(f,d)).rc(c,a,e)}else k(new Aa(d.P))};function kf(a,b,c){dd.call(this,a,b,c)}F(kf,We);function lf(a,b,c,d){Ce.call(this,a,b,c,d)}F(lf,Xe);lf.prototype.executeSql=function(a,b){for(var c=qb(),d=new Ze(a),e=ab(d.b),f=0;f<e.length;f++){var g=X(this.b,e[f]);g||k(new K("store: "+g+" not exists."))}var h=this;R(this.i,"executeSql: "+a+" params: "+b);this.a.j(c,function(a,c,e){Y(h).executeSql(a,c,e,d,b||[])},ab(d.b),d.Oa,"executeSql");return c};function mf(){this.clear()}u=mf.prototype;u.setItem=function(a,b){x(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};u.getItem=function(a){return this.a[a]||q};u.removeItem=function(a){delete this.a[a];$a(this.keys,a.toString());this.length=this.keys.length};u.length=0;u.key=function(a){a=this.keys[a];return x(a)?this.a[a]:q};u.clear=function(){this.a={};this.keys=[];this.length=0};function nf(a){this.g=a||new mf}u=nf.prototype;u.jc=U("ydn.db.con.SimpleStorage");u.Hb=ba(1);u.ta=function(a,b){this.pa=a;this.c=b;this.a={};for(var c=0;c<b.stores.length;c++){var d=b.b(c);this.a[d.getName()]=d.toJSON()}this.indexes={};d=of(this);if(c=sa(this.g.getItem(d)))for(var e in c)c.hasOwnProperty(e)&&!ue(b,e)&&(d=c[e],b.a()?(R(this.jc,"Adding existing store: "+e),this.a[e]=d):(R(this.jc,"Deleting old store: "+e),Od(this,e)));else this.g.setItem(d,J(this.a));return ob(1)};u.fb=function(){return!!this.pa};
u.Gb=function(){return this.g||q};u.ua=ba("memory");u.eb=aa();u.Ua=function(a,b,c,d){a(this);d("complete",{})};u.W=function(a){Kd(function(){for(var b=[],c=this.g.getItem(of(this)).stores,d=0;d<c.length;d++){var e=this.g.getItem(of(this,c[d]));b[d]=new ne(c[d],e.keyPath,e.autoIncrement)}b=new se(this.pa,b);a(b)},0,this)};function of(a,b,c){a=["ydn.db",a.pa];x(b)&&(a.push(b),x(c)&&a.push(yb(c)));return a.join("^|")}
function Nd(a,b,c){b=of(a,b instanceof ne?b.name:b,c);a=a.g.getItem(b);return a=a===q?l:sa(a)}function Md(a,b,c,d){var e;e=X(a.c,c);d=x(d)?d:e.keyPath!=q?qe(e,b):l;x(d)||(e.autoIncrement?(of(a,e.name),d=a.a[e.name],x(d.autoIncrementNo)||(d.autoIncrementNo=a.Xa(e.name,q).length),d.autoIncrementNo++,d=d.autoIncrementNo):k(new Tc));e=d;d=of(a,c,e);b=J(b);a.g.setItem(d,b);if(a=a.a[c].Keys){c=0;for(b=a.length;c<b&&e!=a[c];c++)if(e>a[c]){bb(a,c,0,e);break}}return e}
function Od(a,b,c){if(x(c))a.g.removeItem(of(a,b,c)),a=a.a[b].Keys,x(a)&&$a(a,c);else if(x(b)){a.a[b]&&(a.a[b].Keys=q);c=of(a,b)+"^|";for(b=a.g.length-1;0<=b;b--){var d=a.g.key(b);0==d.lastIndexOf(c,0)&&a.g.removeItem(d)}}else{c=of(a)+"^|";for(b=a.g.length-1;0<=b;b--)d=a.g.key(b),0==d.lastIndexOf(c,0)&&a.g.removeItem(d)}}
u.index=function(a){var b=this.a[a],c=b.Keys;if(c==q){c=[];a=of(this,a);a+="^|";for(var d=0,e=this.g.length;d<e;d++){var f=this.g.key(d);if(0==f.lastIndexOf(a,0)){c.push(f);for(var f=0,g=b.indexes.length;f<g;f++);}}Ta.sort.call(c,fb);b.Keys=c;b.indexes={}}return c};
u.Xa=function(a,b,c,d,e,f){function g(){return e?function(a){return a>c}:function(a){return a>=c}}function h(){return f?function(a){return a<=d}:function(a){return a<d}}b!=q&&k(new fd);a=this.index(a);if(!x(c)&&!x(d))return a;if(x(c)){if(x(d)){b=Ya(a,h());var j=Ya(a,g());return a.slice(b,j)}b=Ya(a,g());return a.slice(b)}b=Ya(a,h());return a.slice(0,b)};function pf(){nf.call(this,window.localStorage)}F(pf,nf);pf.prototype.ua=ba("localstorage");function qf(){nf.call(this,window.sessionStorage)}F(qf,nf);qf.prototype.ua=ba("sessionstorage");var Ge="created",Je="deleted",Ie="updated";function rf(a,b){rd.call(this,a,b)}F(rf,rd);rf.prototype.h=t("e");function sf(a,b,c,d,e){rd.call(this,a,b);this.version=c;this.lc=d;this.kc=e}F(sf,rf);u=sf.prototype;u.name="StorageEvent";u.version=NaN;u.lc=NaN;u.kc=q;u.Tc=t("version");u.xc=t("lc");u.Sc=t("kc");function He(a,b,c,d,e){rd.call(this,a,b);this.e=c;this.key=d;this.value=e}F(He,rf);He.prototype.name="RecordEvent";He.prototype.f=t("key");He.prototype.l=t("value");
function Fe(a,b,c,d,e){rd.call(this,a,b);this.e=c;this.keys=d;this.B=e}F(Fe,rf);Fe.prototype.name="StoreEvent";Fe.prototype.Xa=t("keys");Fe.prototype.f=t("B");function Be(a,b){se.call(this,a,b)}F(Be,se);Be.prototype.a=ba(p);/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");
*/
function Z(a,b,c){md.call(this);c=c||{};var d=["autoSchema","connectionTimeout","size","mechanisms","thread"],e;for(e in c)c.hasOwnProperty(e)&&-1==wa(d,e)&&k(new K('Unknown attribute "'+e+'" in options.'));this.yc=c.mechanisms||tf;this.$b=c.size;this.zc=x(c.connectionTimeout)?c.connectionTimeout:3E4;this.hc=x(c.hc)?c.hc:r;this.a=q;this.h=[];this.Ya=r;if(b instanceof se)e=b;else if(D(b)){e=c.autoSchema||!x(b.stores)?new Be(b):new se(b);c=0;for(d=b.stores?b.stores.length:0;c<d;c++){var f=X(e,b.stores[c].name);
b.stores[c].Sync&&Q(this.f,"Synchronization option for "+f.getName()+" ignored.")}}else e=new Be;this.b=e;x(a)&&this.G(a)}F(Z,Id);Z.prototype.f=U("ydn.db.con.Storage");Z.prototype.Bc=function(a){if(x(a)){var b=function(b){a(b.toJSON())};if(this.a)this.a.W(b);else{var c=this;this.transaction(function(a){c.a.W(b,a)},q,O)}}return this.b?this.b.toJSON():q};
function Ee(a,b){var c=b instanceof ne?b:oe(b),d=b.name,e=X(a.b,d);0==re(c,e).length?ob(r):(e=e?"update":"add",a.b instanceof Be?(a.b.stores.push(c),a.a?(a.a.eb(),a.a=q,uf(a)):ob(r)):k(new hd("Cannot "+e+" store: "+d+". Not auto schema generation mode.")))}Z.prototype.G=function(a){this.a&&k(Error("Already defined with "+this.e));this.e=a;uf(this)};E("ydn.db.con.Storage.prototype.setName",Z.prototype.G);Z.prototype.getName=t("e");var tf=["indexeddb","websql","localstorage","sessionstorage","memory"];
function vf(a,b){return"indexeddb"==b?new we(a.$b,a.zc):"websql"==b?new ze(a.$b):"localstorage"==b?new pf:"sessionstorage"==b?new qf:"memory"==b?new nf:q}
function uf(a){function b(b,d){b?(T(a.f,a+": ready."),a.Rc=NaN,Kd(function(){a.q(d);wf(a)}),N(c,d)):(Q(a.f,a+": database connection fail "+d.name),Kd(function(){a.q(d);if(a.h){a.f.log(wc,"Purging "+a.h.length+" transactions request.",l);for(var b;b=a.h.shift();)b.I&&b.I("error",d)}}),c.m(d))}for(var c=new M,d=q,e=a.yc,f=0;f<e.length;f++){var g=e[f].toLowerCase();if("indexeddb"==g&&ye){d=vf(a,g);break}else if("websql"==g&&ga(v.openDatabase)){d=vf(a,g);break}else if("localstorage"==g&&window.localStorage){d=
vf(a,g);break}else if("sessionstorage"==g&&window.sessionStorage){d=vf(a,g);break}else if("memory"==g){d=vf(a,g);break}}d===q&&(e=new hd("No storage mechanism found."),b(r,new sf("ready",a,NaN,NaN,e)));d.ta(a.e,a.b).C(function(c){a.a=d;b(p,new sf("ready",a,parseFloat(d.Hb()),parseFloat(c),q));d.b=function(){T(a.f,a+": disconnected.")}},function(c){Q(a.f,a+": opening fail: "+c.message);var d=new sf("ready",a,NaN,NaN,c);d.message=c.message;b(r,d)})}Z.prototype.l=function(){if(this.a)return this.a.ua()};
E("ydn.db.con.Storage.prototype.getType",Z.prototype.l);Z.prototype.q=function(a){Jd(this,a)};Z.prototype.bb=function(){this.a&&(this.a.eb(),this.a=q,T(this.f,this+" closed"))};E("ydn.db.con.Storage.prototype.close",Z.prototype.bb);u=Z.prototype;u.Qc=function(){return this.a?this.a.Gb():q};u.Rc=NaN;function wf(a){var b=a.h.shift();b&&(T(a.f,"pop tx queue "+b.ja.name),a.transaction(b.ja,b.Fc,b.mode,b.I));oa()}u.Ya=r;
u.transaction=function(a,b,c,d){var e=b;if(B(b))e=[b];else if(b!=q)if(z(b)){0==b.length&&k(new K("number of store names must more than 0"));for(var f=0;f<b.length;f++)B(b[f])||k(new K("store name at "+f+" must be string but found "+typeof b[f]))}else k(new K("store names must be an array"));else e=q;if(!this.a||!this.a.fb()||this.Ya)b=a,f=d,T(this.f,"push tx queue "+b.name),this.h.push({ja:b,Fc:e,mode:c,I:f}),oa(),100<this.h.length&&0==this.h.length%100&&Q(this.f,"Transaction queue stack size is "+
this.h.length+". It is too large, possibility due to incorrect usage.");else{var g=this,h=x(c)?c:O;h==tb&&(this.Ya=p);this.a.Ua(function(b){a(b);a=q},e,h,function(a,b){ga(d)&&(d(a,b),d=l);h==tb&&(g.Ya=r);wf(g)})}};u.addEventListener=function(a,b,c,d){function e(a){0<=wa(["created","ready","deleted","updated"],a)||k(new K('Invalid event type "'+a+'"'))}if(z(a))for(var f=0;f<a.length;f++)e(a[f]);else e(a);Z.K.addEventListener.call(this,a,b,c,d)};u.toString=function(){return"ydn.db.con.Storage:"+this.a};function de(a){this.e=a;this.a=q;this.b=0}u=de.prototype;u.Wc=U("ydn.db.tr.Mutex");u.kb="";u.J=q;function xf(a,b,c){if(!a.J||!a.mode||c!=a.mode||a.J.length!=b.length)return r;for(c=0;c<b.length;c++)if(-1==a.J.indexOf(b[c]))return r;return p}u.I=q;u.toString=function(){var a;return a="Mutex:"+this.e+":"+this.b+(this.kb?"["+this.kb+"]":"")};function yf(a,b,c,d){this.a=a;this.f=b;this.b=ab(c);this.c=d;this.e=[]}yf.prototype.a=q;yf.prototype.abort=function(){this.a?this.a.abort():k(new Vc("transaction completed"))};yf.prototype.t=t("f");function zf(a,b,c){a.a?(b(a.a),c&&a.e.push(c)):k(new Gb("tx committed on ParallelTxExecutor"))}yf.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.f+" mode:"+this.c+" scopes:"+J(this.b)};function Af(a,b,c){this.g=a;this.e=b;this.b=0;this.Aa=this.O=q;this.c=c||""}u=Af.prototype;u.O=q;u.Aa=q;u.lb=U("ydn.db.tr.Parallel");u.t=t("b");u.type=function(){return this.g.l()};u.abort=function(){R(this.lb,this+": aborting");be(this.Aa)};u.mb=ba(r);
u.ra=function(a,b,c,d){function e(c){h.b++;j=new yf(c,h.b,b,g);T(h.lb,h+":tx"+j.t()+J(b)+g+" begin");h.O=j;zf(h.O,a,d)}function f(a,b){T(h.lb,h+":tx"+j.t()+" committed");for(var c=j,d;d=c.e.shift();)d(a,b);c.a=q;c.b=q;c.e=q}var g=x(c)?c:O,h=this,j;this.O&&this.O.a&&this.mb(b,g)?zf(this.O,a,d):this.g.transaction(e,b,g,f)};u.j=function(a,b,c,d,e,f){var g=this;this.ra(function(c){function d(b,e){g.Aa=c;e?a.m(b):N(a,b);d=g.Aa=q}b(c,g.t(),d)},c,d,f)};
u.toString=function(){var a;a="Parallel:"+this.g.getName();var b=this.c;return a+":"+this.e+":"+this.t()+(b?" :"+b:"")};function Bf(a,b,c){Af.call(this,a,b,c)}F(Bf,Af);Bf.prototype.mb=ba(r);Bf.prototype.j=function(a,b,c,d,e,f){var g,h,j=new M;j.C(function(a){h=r;g=a},function(a){h=p;g=a});Bf.K.j.call(this,j,b,c,d,e,function(b,c){if(h===p)a.m(g);else if(h===r)N(a,g);else{var d=new bd;a.m(d)}f&&(f(b,c),f=l)})};function Cf(a,b){ce.call(this,a,b)}F(Cf,ce);Cf.prototype.c=U("ydn.db.tr.StrictOverflowSerial");Cf.prototype.Lb=function(a,b){return xf(this.a,a,b)};Cf.prototype.Wb=function(){var a=this.a;return!!a&&xf(a,0<this.b.length?this.b[0].J:q,0<this.b.length?this.b[0].mode:q)};function Df(a,b,c){Af.call(this,a,b,c)}F(Df,Af);Df.prototype.mb=function(a,b){var c;a:if(c=this.O,!c.J||!c.c||b!=c.c||c.b.length!=a.length)c=r;else{for(var d=0;d<a.length;d++)if(-1==c.b.indexOf(a[d])){c=r;break a}c=p}return c};function Ef(a,b){ce.call(this,a,b)}F(Ef,ce);Ef.prototype.Lb=function(a,b){var c;a:if(c=this.a,!c.J||!c.mode||b!=c.mode&&(c.mode!=P||b!=O)||a.length>c.J.length)c=r;else{for(var d=0;d<a.length;d++)if(-1==c.J.indexOf(a[d])){c=r;break a}c=p}return c};function Ff(a,b,c){Af.call(this,a,b,c)}F(Ff,Af);Ff.prototype.mb=function(a,b){var c;a:if(c=this.O,!c.b||!c.c||b!=c.c&&(c.c!=P||b!=O)||a.length>c.b.length)c=r;else{for(var d=0;d<a.length;d++)if(-1==c.b.indexOf(a[d])){c=r;break a}c=p}return c};function Gf(a,b,c){Af.call(this,a,b,c);this.a=r}F(Gf,Af);Gf.prototype.a=r;Gf.prototype.j=function(a,b,c,d,e,f){function g(c){function d(b,e){h.Aa=c;e?a.m(b):N(a,b);d=h.Aa=q}b(c,h.t(),d);b=q}var h=this;this.O&&this.O.a?zf(this.O,g,f):(this.a&&(Ec(this.lb,"single thread has already committed the transaction"),k(new Vc)),this.a=p,this.ra(g,c,d,f))};function Hf(a,b,c){Z.call(this,a,b,c);this.w=0;a="serial";c&&c.thread&&(a=ae.indexOf(c.thread),-1==a&&k(new ed("thread: "+c.thread)),a=ae[a]);this.$a=a;this.c=this.Mb(this.$a,"base")}F(Hf,Z);u=Hf.prototype;u.w=0;u.Mb=function(a,b){this.w++;b=b||"branch"+this.w;var c=If(this,a,b);return this.Ka(c,q,b)};u.t=function(){return this.c?this.c.t():NaN};u.Ka=function(a,b,c){return new Ce(this,this.b,c||"",a)};
function If(a,b,c){b=b||a.$a;if("serial"==b)return new ce(a,a.w++);if("parallel"==b)return new Af(a,a.w++,c);if("atomic-parallel"==b)return new Bf(a,a.w++,c);if("atomic-serial"==b)return new ee(a,a.w++);if("samescope-multirequest-parallel"==b)return new Df(a,a.w++,c);if("samescope-multirequest-serial"==b)return new Cf(a,a.w++);if("multirequest-parallel"==b)return new Ff(a,a.w++,c);if("multirequest-serial"==b)return new Ef(a,a.w++);if("single"==b)return new Gf(a,a.w++,c);k(new K('invalid transaction policy thread type "'+
b+'"'))}u.abort=function(){return this.c.abort()};
u.Ec=function(a,b,c,d,e){var f=this;this.w++;var g=B(a.name)&&0<a.name.length?a.name:"run"+this.w,h=If(this,"single",g),j=this.Ka(h,q,g),n=c||O;-1==[O,P].indexOf(n)&&k(new K("invalid mode"));b!=q||(b=te(this.b));if(z(b)){0==b.length&&k(new K("number of store names must more than 0"));for(var m=0;m<b.length;m++)B(b[m])||k(new K("store name at "+m+" must be string but found "+typeof b[m]))}else k(new K("store names must be an array"));var s=a;if(4<arguments.length)var w=Array.prototype.slice.call(arguments,
4),s=function(){var b=Array.prototype.slice.call(arguments),b=b.concat(w);return a.apply(this,b)};T(this.f,"scheduling run in transaction "+g+" with "+h);h.ra(function(){T(f.f,"executing run in transaction "+g);s(j);s=q},b,n,d)};function $(a,b,c){Hf.call(this,a,b,c)}F($,Hf);u=$.prototype;u.Ka=function(a,b,c){return new De(this,this.b,c||"",a)};u.yb=function(a){var b=this.l();if("indexeddb"==b)return new kd(this.e,this.b,a);if("websql"==b)return new Pd(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new Ld(this.e,this.b,a);k(new Uc("No executor for "+b))};u.gb=function(a,b,c){return this.c.gb(a,b,c)};u.va=function(a,b,c){return this.c.va(a,b,c)};u.wa=function(a,b){return this.c.wa(a,b)};
u.keys=function(a,b,c,d,e,f){return this.c.keys(a,b,c,d,e,f)};u.B=function(a,b,c,d,e,f){return this.c.B(a,b,c,d,e,f)};u.xa=function(a,b,c){return this.c.xa(a,b,c)};u.clear=function(a,b,c){return this.c.clear(a,b,c)};u.hb=function(a,b,c){return this.c.hb(a,b,c)};u.toString=function(){return"Storage:"+this.getName()+":"+this.t()};function Jf(a,b,c){Hf.call(this,a,b,c)}F(Jf,$);u=Jf.prototype;u.yb=function(a){var b=this.l();if("indexeddb"==b)return new Re(this.e,this.b,a);if("websql"==b)return new Ue(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new We(this.e,this.b,a);k(new Uc("No executor for "+b))};u.Ka=function(a,b,c){return new Xe(this,this.b,c||"",a)};u.Uc=function(a,b,c){return this.c.mc(a,b,c)};u.Vc=function(a,b,c){return this.c.nc(a,b,c)};u.map=function(a,b){return this.c.map(a,b)};
u.reduce=function(a,b,c){return this.c.reduce(a,b,c)};function Kf(a,b,c){Hf.call(this,a,b,c)}F(Kf,Jf);Kf.prototype.yb=function(a){var b=this.l();if("indexeddb"==b)return new ef(this.e,this.b,a);if("websql"==b)return new jf(this.e,this.b,a);if("memory"==b||"localstorage"==b||"sessionstorage"==b)return new kf(this.e,this.b,a);k(new Uc("No executor for "+b))};Kf.prototype.Ka=function(a,b,c){return new lf(this,this.b,c||"",a)};Kf.prototype.executeSql=function(a,b){return this.c.executeSql(a,b)};function Lf(a,b,c){Hf.call(this,a,b,c)}F(Lf,Kf);function Mf(a,b){Pe.call(this,a,b)}F(Mf,Pe);Mf.prototype.b=ba(r);Mf.prototype.c=function(a,b){function c(b){x(a[b])?(e=r,d[b]=p):(d[b]=r,0<=b-1&&c(b-1))}var d=[],e=p;c(a.length-1);e&&(d=[]);var f;a:{f=d;var g,h=g!=q;if(!x(g)){g=b[0];for(var h=g!=q,j=1;h&&j<b.length;j++)if(b[j]==q||0!=ya(b[j],g))h=r}if(h&&(this.f++,this.a&&this.a.push(g),x(this.h)&&this.f>=this.h)){f=[];break a}}return f};function Nf(a,b){Pe.call(this,a,b);this.e=a instanceof Le&&!!a.sa}F(Nf,Pe);Nf.prototype.l=U("ydn.db.algo.ZigzagMerge");Nf.prototype.e=r;Nf.prototype.b=function(a,b){var c=Nf.K.b.call(this,a,b);if(this.e){var d=a[0].Da().split(", ");1<d.length?d[d.length-1]!=this.a.sa&&k(new Rc("Output streamer projection field must be same as postfix field in the iterator")):Q(this.l,"Unable to check correctness of output streamer.")}return c};
Nf.prototype.c=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}var d=[];if(0==a.length||a[0]==q||a[0]==q)return[];for(var e=p,f=0,g=a[f][a[f].length-1],h=[],j=1;j<a.length;j++)if(a[j]!=q){var n=a[j][a[j].length-1],m=ya(g,n);h[j]=m;1===m?e=r:-1===m&&(e=r,g=n,f=1)}else return[];if(e){for(e=0;e<a.length;e++)a[e]!=q&&(d[e]=p);this.a&&(this.e?this.a.push(b[0],g):this.a.push(b[0]));return d}if(0==f)for(e=1;e<a.length;e++)1===h[e]&&(d[e]=c(a[e],g));else for(e=0;e<a.length;e++)e!=
f&&a[e]!=q&&1===ya(g,a[e][a[e].length-1])&&(d[e]=c(a[e],g));return{"continue":d}};function Of(a,b){Pe.call(this,a,b)}F(Of,Pe);Of.prototype.b=ba(r);Of.prototype.c=function(a,b){var c=[],d=b[0];if(d==q)return[];for(var e=p,f=r,g=d,h=[],j=1;j<a.length;j++)if(b[j]!=q){var n=ya(d,b[j]);h[j]=n;1===n?e=r:-1===n&&(e=r,f=p,1===ya(b[j],g)&&(g=b[j]))}else e=r,f=p;if(e)for(f=0;f<a.length;f++)b[f]!=q&&(c[f]=p);else if(f)for(f=0;f<a.length;f++)b[f]!=q&&1===ya(g,b[f])&&(c[f]=g);else for(f=1;f<a.length;f++)1===h[f]&&(c[f]=d);return e?(this.f++,this.a&&this.a.push(g),c):{continuePrimary:c}};E("ydn.db.Storage",Lf);E("ydn.db.algo.NestedLoop",Mf);E("ydn.db.algo.ZigzagMerge",Nf);E("ydn.db.algo.SortedMerge",Of);M.prototype.done=M.prototype.ba;M.prototype.fail=M.prototype.Nb;M.prototype.then=M.prototype.C;M.prototype.always=M.prototype.sc;Id.prototype.addEventListener=Id.prototype.addEventListener;E("ydn.db.con.Storage",Z);Z.prototype.onReady=Z.prototype.q;Z.prototype.getType=Z.prototype.l;Z.prototype.setName=Z.prototype.G;Z.prototype.getName=Z.prototype.getName;Z.prototype.getSchema=Z.prototype.Bc;Z.prototype.transaction=Z.prototype.transaction;Z.prototype.close=Z.prototype.bb;E("ydn.db.version","0.4.6");
E("ydn.db.deleteDatabase",function(a,b){ye&&((!b||"indexeddb"==b)&&ye&&"deleteDatabase"in ye)&&ye.deleteDatabase(a);if(ga(v.openDatabase)&&(!b||"websql"==b)){var c=new ze,d=new Be;R(c.o,"deleting websql database: "+a);var d=c.ta(a,d),e=function(){c.o.log(wc,"all tables in "+a+" deleted.",l)};d.ba(function(){c.Ua(function(b){c.W(function(d){var e=d.stores.length;if(0<e)for(var f=0;f<e;f++){var m=d.b(f);T(c.o,"deleting table: "+m.getName());b.executeSql("DROP TABLE "+Vd(m))}else c.o.log(wc,"no table to delete in "+
a,l)},b)},[],P,e)});d.Nb(function(){Q(c.o,"Connecting "+a+" failed.")})}if(!b||"localstorage"==b){var d=new pf,f=new Be;d.ta(a,f);Od(d)}if(!b||"sessionstorage"==b)d=new qf,f=new Be,d.ta(a,f),Od(d)});sf.prototype.name=sf.prototype.name;sf.prototype.getVersion=sf.prototype.Tc;sf.prototype.getOldVersion=sf.prototype.xc;sf.prototype.getError=sf.prototype.Sc;Hf.prototype.branch=Hf.prototype.Mb;Hf.prototype.run=Hf.prototype.Ec;Ce.prototype.abort=Ce.prototype.abort;Hf.prototype.abort=Hf.prototype.abort;E("ydn.db.crud.Storage",$);$.prototype.branch=$.prototype.Mb;$.prototype.add=$.prototype.gb;$.prototype.get=$.prototype.wa;$.prototype.values=$.prototype.B;$.prototype.put=$.prototype.xa;$.prototype.clear=$.prototype.clear;$.prototype.remove=$.prototype.hb;$.prototype.count=$.prototype.va;De.prototype.add=De.prototype.gb;De.prototype.get=De.prototype.wa;De.prototype.values=De.prototype.B;De.prototype.put=De.prototype.xa;De.prototype.clear=De.prototype.clear;De.prototype.remove=De.prototype.hb;
De.prototype.count=De.prototype.va;E("ydn.db.cmp",ya);E("ydn.db.Key",cd);cd.prototype.id=cd.prototype.wc;cd.prototype.parent=cd.prototype.Oc;cd.prototype.storeName=cd.prototype.Pc;E("ydn.db.KeyRange",H);H.upperBound=function(a,b){return new H(l,a,l,b)};H.lowerBound=function(a,b){return new H(a,l,b,l)};H.bound=qa;H.only=function(a){return new H(a,a,r,r)};H.starts=ra;rf.prototype.store_name=rf.prototype.e;rf.prototype.getStoreName=rf.prototype.h;He.prototype.name=He.prototype.name;
He.prototype.getKey=He.prototype.f;He.prototype.getValue=He.prototype.l;Fe.prototype.name=Fe.prototype.name;Fe.prototype.getKeys=Fe.prototype.Xa;Fe.prototype.getValues=Fe.prototype.f;Jf.prototype.scan=Jf.prototype.Vc;Jf.prototype.map=Jf.prototype.map;Jf.prototype.reduce=Jf.prototype.reduce;Jf.prototype.open=Jf.prototype.Uc;Xe.prototype.scan=Xe.prototype.nc;Xe.prototype.map=Xe.prototype.map;Xe.prototype.reduce=Xe.prototype.reduce;Xe.prototype.open=Xe.prototype.mc;Oe.prototype.key=Oe.prototype.oc;Qe.prototype.primaryKey=Qe.prototype.r;Qe.prototype.value=Qe.prototype.ib;Qe.prototype.update=Qe.prototype.Kb;Qe.prototype.clear=Qe.prototype.clear;Se.prototype.primaryKey=Se.prototype.r;
Se.prototype.value=Se.prototype.ib;Se.prototype.update=Se.prototype.Kb;Se.prototype.clear=Se.prototype.clear;E("ydn.math.Expression",Ye);Ye.prototype.evaluate=Ye.prototype.b;Ye.prototype.compile=Ye.prototype.c;Ye.parseRpn=function(a){return new Ye(a.match(/[^\s"']+|"[^"]*"|'[^']*'/g))};Ye.parseInfix=function(){k(new fd("Too lazy to learn Dutch in Shunting Yard station, we speak Polish here."))};E("ydn.db.Iterator",V);E("ydn.db.KeyCursors",Kc);E("ydn.db.ValueCursors",Mc);E("ydn.db.Cursors",Lc);
E("ydn.db.IndexValueCursors",Nc);V.prototype.count=V.prototype.Gc;V.prototype.done=V.prototype.vc;V.prototype.getKeyRange=V.prototype.Ic;V.prototype.getIndexName=V.prototype.Da;V.prototype.getStoreName=V.prototype.Jc;V.prototype.isReversed=V.prototype.Lc;V.prototype.isUnique=V.prototype.Mc;V.prototype.isKeyOnly=V.prototype.Kc;V.prototype.primaryKey=V.prototype.r;V.prototype.key=V.prototype.Hc;V.prototype.resume=V.prototype.Dc;V.prototype.reset=V.prototype.Nc;
Kc.where=function(a,b,c,d,e){return new Kc(a,Ba(b,c,d,e))};Mc.where=function(a,b,c,d,e){return new Mc(a,Ba(b,c,d,e))};Lc.where=function(a,b,c,d,e,f){return new Lc(a,b,Ba(c,d,e,f))};Nc.where=function(a,b,c,d,e,f){return new Nc(a,b,Ba(c,d,e,f))};E("ydn.db.Streamer",Le);Le.prototype.push=Le.prototype.push;Le.prototype.collect=Le.prototype.uc;Le.prototype.setSink=Le.prototype.fc;var Pf=new function(){this.a=oa()};function Qf(a){this.e=a||"";this.f=Pf}Qf.prototype.a=p;Qf.prototype.b=r;function Rf(a){a=new Date(a.h);return Sf(a.getFullYear()-2E3)+Sf(a.getMonth()+1)+Sf(a.getDate())+" "+Sf(a.getHours())+":"+Sf(a.getMinutes())+":"+Sf(a.getSeconds())+"."+Sf(Math.floor(a.getMilliseconds()/10))}function Sf(a){return 10>a?"0"+a:String(a)}function Tf(a,b){var c=(a.h-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function Uf(a){Qf.call(this,a)}F(Uf,Qf);Uf.prototype.b=p;
Uf.prototype.c=function(a){var b;switch(a.f.value){case tc.value:b="dbg-sh";break;case uc.value:b="dbg-sev";break;case vc.value:b="dbg-w";break;case wc.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.e," ");this.a&&c.push("[",Rf(a),"] ");c.push("[",La(Tf(a,this.f.a)),"s] ");c.push("[",Fa(a.c),"] ");c.push('<span class="',b,'">',Ea(La(Fa(a.e))));this.b&&a.b&&c.push("<br>",Ea(La(a.a||"")));c.push("</span><br>");return c.join("")};function Vf(a){Qf.call(this,a)}F(Vf,Qf);
Vf.prototype.c=function(a){var b=[];b.push(this.e," ");this.a&&b.push("[",Rf(a),"] ");b.push("[",Tf(a,this.f.a),"s] ");b.push("[",a.c,"] ");b.push(a.e,"\n");this.b&&a.b&&b.push(a.a,"\n");return b.join("")};function Wf(){this.f=ma(this.h,this);this.a=new Vf;this.a.a=r;this.b=this.a.b=r;this.c="";this.e={}}Wf.prototype.h=function(a){if(!this.e[a.c]){var b=this.a.c(a),c=Xf;if(c)switch(a.f){case tc:Yf(c,"info",b);break;case uc:Yf(c,"error",b);break;case vc:Yf(c,"warn",b);break;default:Yf(c,"debug",b)}else window.opera?window.opera.postError(b):this.c+=b}};var Xf=window.console;function Yf(a,b,c){if(a[b])a[b](c);else a.log(c)};var Zf,$f=!Xb||Xb&&9<=jc;!Yb&&!Xb||Xb&&Xb&&9<=jc||Yb&&hc("1.9.1");Xb&&hc("9");function ag(a,b){var c;c=a.className;c=B(c)&&c.match(/\S+/g)||[];for(var d=cb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=wa(f,d[g])||f.push(d[g]);f=c.join(" ");a.className=f;return c.length==e};var bg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function cg(a){this.a=a||v.document||document}function dg(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
cg.prototype.b=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!$f&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',Fa(g.name),'"');if(g.type){f.push(' type="',Fa(g.type),'"');var h={};Lb(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=d.createElement(f);if(g)if(B(g))f.className=g;else if(y(g))ag.apply(q,[f].concat(g));else{var j=f;Ib(g,function(a,b){"style"==b?j.style.cssText=a:"class"==b?j.className=a:"for"==b?j.htmlFor=a:b in bg?j.setAttribute(bg[b],a):0==b.lastIndexOf("aria-",
0)||0==b.lastIndexOf("data-",0)?j.setAttribute(b,a):j[b]=a})}if(2<e.length)for(var n=d,m=f,d=e,e=function(a){a&&m.appendChild(B(a)?n.createTextNode(a):a)},g=2;g<d.length;g++)if(h=d[g],z(h)&&!(D(h)&&0<h.nodeType)){var s=Ua,w;a:{if((w=h)&&"number"==typeof w.length){if(D(w)){w="function"==typeof w.item||"string"==typeof w.item;break a}if(ga(w)){w="function"==typeof w.item;break a}}w=r}s(w?ab(h):h,e)}else e(h);return f};
cg.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function eg(a){this.f=ma(this.h,this);this.b=new Uf;this.c=this.b.a=r;this.a=a;this.e=this.a.ownerDocument||this.a.document;var b=(a=this.a)?new cg(9==a.nodeType?a:a.ownerDocument||a.document):Zf||(Zf=new cg),c=q;Xb?(a=c=b.a.createStyleSheet(),Xb?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"):(a=dg(b,"head")[0],a||(c=dg(b,"body")[0],a=b.b("head"),c.parentNode.insertBefore(a,c)),b=c=b.b("style"),Xb?b.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
b.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}",a.appendChild(c));this.a.className+=" logdiv"}
eg.prototype.h=function(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.e.createElement("div");c.className="logmsg";c.innerHTML=this.b.c(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)};eg.prototype.clear=function(){this.a.innerHTML=""};var fg=q,gg=q;E("ydn.debug.log",function(a,b,c){if(C(b))b=new sc("log",b);else if(B(b)){b=b.toUpperCase();if(!Cc){Cc={};for(var d=0,e;e=Bc[d];d++)Cc[e.value]=e,Cc[e.name]=e}b=Cc[b]||q}else b=yc;U(a||"ydn").b=b;x(c)?gg||(a=gg=new eg(c),p!=a.c&&(c=Jc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.c=p),Jc().b=vc):!fg&&!gg&&(a=fg=new Wf,p!=a.b&&(c=Jc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.b=p),Jc().b=vc)});Z.prototype.db=Z.prototype.Qc;})();

            //@ sourceMappingURL=zvt-ydn.db-dev.js.map
        